<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>Power Box Controller Arduino Code</title>
    <url>/2024/04/30/powerBoxControl20240430/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>The Arduino code is in the following.</p>
<span id="more"></span> 

<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">  Title: Dual Relay Controller</span></span><br><span class="line"><span class="comment">  Made by: YX</span></span><br><span class="line"><span class="comment">  Location: Melbourne</span></span><br><span class="line"><span class="comment">  Date: 20240430</span></span><br><span class="line"><span class="comment">  Description: This program is designed to control two relays, one mechanical and one SSR (Solid State Relay),</span></span><br><span class="line"><span class="comment">  allowing for triggering via serial commands.</span></span><br><span class="line"><span class="comment">  Expansion: The function can be extended to measure AC power, voltage, current when using PZEM004T.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;PWMaa.h&gt;</span>  <span class="comment">// Include the PWM frequency library https://code.google.com/archive/p/arduino-pwm-frequency-library/downloads</span></span></span><br><span class="line"><span class="comment">// edit ATimerDefs.h and add &#x27;(0,0,0,0,0), // TIMER1C&#x27;  after Line 107</span></span><br><span class="line"><span class="comment">// if applied to Arduino Mega 2560</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;PZEM004Tv30.h&gt;</span>  <span class="comment">// Power meter library</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="comment">// The RX and TX pins that the PZEM004Tv30 is connected to</span></span><br><span class="line"><span class="function">PZEM004Tv30 <span class="title">pzemOT1</span><span class="params">(<span class="number">68</span>, <span class="number">69</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Variables to store the readings</span></span><br><span class="line"><span class="type">float</span> power1;</span><br><span class="line"><span class="type">float</span> voltage1;</span><br><span class="line"><span class="type">float</span> current1;</span><br><span class="line"><span class="type">float</span> factor1;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Variable to store a combined value (not used in this snippet)</span></span><br><span class="line"><span class="type">float</span> powerx;</span><br><span class="line"><span class="comment">// The pin that controls the relay</span></span><br><span class="line"><span class="type">int</span> relayPin = <span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Timer and frequency for the PWM output (pin 5 for UNO, pin 11 for MEGA)</span></span><br><span class="line"><span class="type">int</span> ledTimer1 = <span class="number">5</span>;</span><br><span class="line"><span class="type">int32_t</span> frequency = <span class="number">1</span>;  <span class="comment">// 1Hz frequency</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> mark;</span><br><span class="line"><span class="comment">// Serial communication buffer and state variables</span></span><br><span class="line"><span class="type">const</span> byte numChars = <span class="number">32</span>;</span><br><span class="line"><span class="type">char</span> comdata[numChars];</span><br><span class="line">boolean newData = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Setup initializes the system</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// Initialize all timers except for 0, to keep the millis()/micros() functions working</span></span><br><span class="line">  <span class="built_in">InitTimersSafe</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Set the frequency for pin 5</span></span><br><span class="line">  <span class="type">bool</span> success1 = <span class="built_in">SetPinFrequencySafe</span>(ledTimer1, frequency);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Setup the relay pin</span></span><br><span class="line">  <span class="built_in">pinMode</span>(relayPin, OUTPUT);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(relayPin, LOW);  <span class="comment">// Ensure the relay starts off</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// Start the serial communication</span></span><br><span class="line">  Serial.<span class="built_in">begin</span>(<span class="number">115200</span>);</span><br><span class="line">  <span class="keyword">while</span> (!Serial) &#123;</span><br><span class="line">    ;  <span class="comment">// wait for serial port to connect. Needed for native USB</span></span><br><span class="line">  &#125;</span><br><span class="line">  Serial.<span class="built_in">println</span>(<span class="string">&quot;Power box ready&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="comment">// If there&#x27;s new data from the serial input, handle it</span></span><br><span class="line">  <span class="built_in">recvWithStartEndMarkers</span>();</span><br><span class="line">  <span class="keyword">if</span> (newData == <span class="literal">true</span>) &#123;</span><br><span class="line">    String command = comdata;  <span class="comment">// Convert char array to String for easier manipulation</span></span><br><span class="line">    <span class="keyword">if</span> (command.<span class="built_in">startsWith</span>(<span class="string">&quot;F&quot;</span>)) &#123;</span><br><span class="line">      <span class="built_in">pwmWrite</span>(ledTimer1, <span class="number">0</span>);  <span class="comment">// Turn off PWM</span></span><br><span class="line">      <span class="built_in">digitalWrite</span>(relayPin,LOW); <span class="comment">// turn off Mechanical Relay</span></span><br><span class="line">      <span class="built_in">delay</span>(<span class="number">10</span>);</span><br><span class="line">      mark = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (command.<span class="built_in">startsWith</span>(<span class="string">&quot;PWR&quot;</span>)) &#123;</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Power reading:&quot;</span>);</span><br><span class="line">      powerx = pzemOT1.<span class="built_in">power</span>();</span><br><span class="line">      <span class="comment">// voltage1 = pzemOT1.voltage();</span></span><br><span class="line">      <span class="comment">// current1 = pzemOT1.current();</span></span><br><span class="line">      <span class="comment">// power1 = voltage1 * current1;</span></span><br><span class="line">      <span class="keyword">if</span> (!<span class="built_in">isnan</span>(powerx)) &#123;</span><br><span class="line">        Serial.<span class="built_in">println</span>(powerx);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        Serial.<span class="built_in">println</span>(<span class="string">&quot;Error: Power data is not available.&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (command.<span class="built_in">startsWith</span>(<span class="string">&quot;S&quot;</span>)) &#123;</span><br><span class="line">      <span class="keyword">if</span> (command.<span class="built_in">charAt</span>(<span class="number">1</span>) == <span class="string">&#x27;O&#x27;</span>) &#123;</span><br><span class="line">        Serial.<span class="built_in">println</span>(<span class="string">&quot;Relay On&quot;</span>);</span><br><span class="line">        <span class="built_in">digitalWrite</span>(relayPin, HIGH);</span><br><span class="line">      &#125; <span class="keyword">else</span> <span class="keyword">if</span> (command.<span class="built_in">charAt</span>(<span class="number">1</span>) == <span class="string">&#x27;F&#x27;</span>) &#123;</span><br><span class="line">        Serial.<span class="built_in">println</span>(<span class="string">&quot;Relay Off&quot;</span>);</span><br><span class="line">        <span class="built_in">digitalWrite</span>(relayPin, LOW);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    newData = <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This function reads data from serial until a new line character is received</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">recvWithStartEndMarkers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="type">static</span> boolean recvInProgress = <span class="literal">false</span>;</span><br><span class="line">  <span class="type">static</span> byte ndx = <span class="number">0</span>;</span><br><span class="line">  <span class="type">char</span> startMarker = <span class="string">&#x27;&lt;&#x27;</span>;</span><br><span class="line">  <span class="type">char</span> endMarker = <span class="string">&#x27;&gt;&#x27;</span>;</span><br><span class="line">  <span class="type">char</span> rc;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span> (Serial.<span class="built_in">available</span>() &gt; <span class="number">0</span> &amp;&amp; newData == <span class="literal">false</span>) &#123;</span><br><span class="line">    rc = Serial.<span class="built_in">read</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (recvInProgress == <span class="literal">true</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (rc != endMarker) &#123;</span><br><span class="line">        comdata[ndx] = rc;</span><br><span class="line">        ndx++;</span><br><span class="line">        <span class="keyword">if</span> (ndx &gt;= numChars) &#123;</span><br><span class="line">          ndx = numChars - <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        comdata[ndx] = <span class="string">&#x27;\0&#x27;</span>;  <span class="comment">// terminate the string</span></span><br><span class="line">        recvInProgress = <span class="literal">false</span>;</span><br><span class="line">        ndx = <span class="number">0</span>;</span><br><span class="line">        newData = <span class="literal">true</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (rc == startMarker) &#123;</span><br><span class="line">      recvInProgress = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>research</category>
      </categories>
      <tags>
        <tag>Arduino Code</tag>
      </tags>
  </entry>
  <entry>
    <title>Motor/Encoder Control Code</title>
    <url>/2024/04/25/motorEncoderController202404/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>The Arduino code is in the following.</p>
<span id="more"></span> 

<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">Title: Controller Box Code</span></span><br><span class="line"><span class="comment">Description: This code is used for a controller box with a single-end encoder and a four-wire step motor (with the current up to 4 A).</span></span><br><span class="line"><span class="comment">Created by: YX at Melboune, 202404 </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * Arduino Code for Controlling Motor and Reading Encoder</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * Instructions:</span></span><br><span class="line"><span class="comment"> * 1. Connect your Arduino board to a serial terminal program (e.g., Arduino IDE&#x27;s Serial Monitor or a dedicated serial terminal software).</span></span><br><span class="line"><span class="comment"> * 2. Set the baud rate of the serial terminal program to match the baud rate set in this code (115200).</span></span><br><span class="line"><span class="comment"> * 3. Send command strings to the board via the serial terminal program for various operations.</span></span><br><span class="line"><span class="comment"> *    - To get the encoder value, send the command string &quot;E&quot;.</span></span><br><span class="line"><span class="comment"> *    - To drive the motor forward by a certain number of steps, send the command string &quot;+N&quot;, where N is the desired number of steps.</span></span><br><span class="line"><span class="comment"> *    - To drive the motor backward by a certain number of steps, send the command string &quot;-N&quot;, where N is the desired number of steps.</span></span><br><span class="line"><span class="comment"> *    - To set the motor current, send the command string &quot;A&lt;current&gt;&quot;, where &lt;current&gt; is the desired current value in milliamperes.</span></span><br><span class="line"><span class="comment"> * 4. The board will process the commands and display the results or feedback in the serial terminal program.</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;SPI.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;HighPowerStepperDriver.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;Arduino.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;Servo.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;digitalWriteFast.h&gt;</span>  <span class="comment">// library for high performance reads and writes by jrraines</span></span></span><br><span class="line">                               <span class="comment">// see http://www.arduino.cc/cgi-bin/yabb2/YaBB.pl?num=1267553811/0</span></span><br><span class="line">                               <span class="comment">// and http://code.google.com/p/digitalwritefast/</span></span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span> DirPin = <span class="number">8</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span> StepPin = <span class="number">9</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span> CSPin = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span> SleepPin = <span class="number">7</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span> RstPin   = <span class="number">6</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">uint8_t</span> FaultPin   = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// This period is the length of the delay between steps, which controls the</span></span><br><span class="line"><span class="comment">// stepper motor&#x27;s speed.  You can increase the delay to make the stepper motor</span></span><br><span class="line"><span class="comment">// go slower.  If you decrease the delay, the stepper motor will go faster, but</span></span><br><span class="line"><span class="comment">// there is a limit to how fast it can go before it starts missing steps.</span></span><br><span class="line"><span class="type">const</span> <span class="type">uint16_t</span> StepPeriodUs = <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> ch;</span><br><span class="line"><span class="type">float</span> DutyCircle;</span><br><span class="line"><span class="type">const</span> byte numChars = <span class="number">32</span>;</span><br><span class="line"><span class="type">char</span> comdata[numChars];</span><br><span class="line"><span class="type">int</span> motorState;</span><br><span class="line"></span><br><span class="line">boolean newData = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">HighPowerStepperDriver sd;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Quadrature encoders</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> zChannel 4</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EncoderPinA 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EncoderPinB 3</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> EncoderIsReversed</span></span><br><span class="line"><span class="keyword">volatile</span> <span class="type">bool</span> EncoderBSet;</span><br><span class="line"><span class="keyword">volatile</span> <span class="type">long</span> EncoderTicks = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> flagA = <span class="number">0</span>;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">int</span> flagB = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setup</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   Serial.<span class="built_in">begin</span>(<span class="number">115200</span>);</span><br><span class="line">  <span class="comment">// Serial.println(&quot;Waiting for sending a signal...\n&quot;);</span></span><br><span class="line">  SPI.<span class="built_in">begin</span>();</span><br><span class="line">  sd.<span class="built_in">setChipSelectPin</span>(CSPin);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Drive the STEP and DIR pins low initially.</span></span><br><span class="line">  <span class="built_in">pinMode</span>(StepPin, OUTPUT);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(StepPin, LOW);</span><br><span class="line">  <span class="built_in">pinMode</span>(DirPin, OUTPUT);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(DirPin, LOW);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">pinMode</span>(SleepPin, OUTPUT);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(SleepPin, HIGH);</span><br><span class="line">  <span class="built_in">pinMode</span>(RstPin, OUTPUT);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(RstPin, LOW);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">pinMode</span>(FaultPin, INPUT);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Give the driver some time to power up.</span></span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">10</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Reset the driver to its default settings and clear latched status</span></span><br><span class="line">  <span class="comment">// conditions.</span></span><br><span class="line">  sd.<span class="built_in">resetSettings</span>();</span><br><span class="line">  sd.<span class="built_in">clearStatus</span>();</span><br><span class="line">  <span class="comment">// Select auto mixed decay.  TI&#x27;s DRV8711 documentation recommends this mode</span></span><br><span class="line">  <span class="comment">// for most applications, and we find that it usually works well.</span></span><br><span class="line">  sd.<span class="built_in">setDecayMode</span>(HPSDDecayMode::AutoMixed);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Set the current limit. You should change the number here to an appropriate</span></span><br><span class="line">  <span class="comment">// value for your particular system.</span></span><br><span class="line">  sd.<span class="built_in">setCurrentMilliamps36v4</span>(<span class="number">600</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Set the number of microsteps that correspond to one full step.</span></span><br><span class="line">  sd.<span class="built_in">setStepMode</span>(HPSDStepMode::MicroStep4);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Enable the motor outputs.</span></span><br><span class="line">  sd.<span class="built_in">enableDriver</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// Quardrature</span></span><br><span class="line">   <span class="built_in">pinMode</span>(EncoderPinA, INPUT);      <span class="comment">// sets pin A as input</span></span><br><span class="line">  <span class="built_in">digitalWrite</span>(EncoderPinA, LOW);  <span class="comment">// </span></span><br><span class="line">  <span class="built_in">pinMode</span>(EncoderPinB, INPUT);      <span class="comment">// sets pin B as input</span></span><br><span class="line">  <span class="built_in">digitalWrite</span>(EncoderPinB, LOW);  <span class="comment">//  </span></span><br><span class="line">  <span class="built_in">pinMode</span>(zChannel,INPUT);</span><br><span class="line">  <span class="built_in">attachInterrupt</span>(<span class="built_in">digitalPinToInterrupt</span>(EncoderPinA), HandleInterruptA, RISING);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">loop</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">checkStatus</span>();</span><br><span class="line">  <span class="keyword">while</span> (!Serial) &#123;</span><br><span class="line">    ; <span class="comment">// wait for serial port to connect. Needed for native USB</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (Serial.<span class="built_in">available</span>() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        newData = <span class="literal">false</span>;</span><br><span class="line">    <span class="built_in">recvWithStartEndMarkers</span>();</span><br><span class="line">   <span class="keyword">if</span> (newData == <span class="literal">true</span>)&#123;</span><br><span class="line"></span><br><span class="line">   <span class="keyword">if</span> (comdata[<span class="number">0</span>] == <span class="string">&#x27;+&#x27;</span> || comdata[<span class="number">0</span>] == <span class="string">&#x27;-&#x27;</span> || comdata[<span class="number">0</span>] == <span class="string">&#x27;A&#x27;</span> || comdata[<span class="number">0</span>] == <span class="string">&#x27;E&#x27;</span>)&#123;</span><br><span class="line">    ch = comdata[<span class="number">0</span>];</span><br><span class="line">    <span class="type">char</span>* numStart = &amp;comdata[<span class="number">1</span>];     <span class="comment">// Pointer to the start of the numerical part of the string.</span></span><br><span class="line">    <span class="type">char</span>* endptr;</span><br><span class="line">    <span class="type">long</span> stepp = <span class="built_in">strtol</span>(numStart, &amp;endptr, <span class="number">10</span>);</span><br><span class="line">    <span class="keyword">if</span> (numStart == endptr) &#123;</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Error: No digits were found after the sign. Please re-enter the command.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;  <span class="comment">// Skip the rest of the loop and wait for new input.</span></span><br><span class="line">     &#125; <span class="keyword">else</span> <span class="keyword">if</span> (*endptr != <span class="string">&#x27;\0&#x27;</span>) &#123;</span><br><span class="line">      Serial.<span class="built_in">println</span>(<span class="string">&quot;Error: Extra characters after number. Please re-enter the command.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;  <span class="comment">// Skip the rest of the loop and wait for new input.</span></span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (comdata[<span class="number">0</span>] == <span class="string">&#x27;+&#x27;</span> || comdata[<span class="number">0</span>] == <span class="string">&#x27;-&#x27;</span>) &#123;</span><br><span class="line">          <span class="built_in">DoSerial</span>(ch, stepp);</span><br><span class="line">            &#125;</span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">if</span> (comdata[<span class="number">0</span>] == <span class="string">&#x27;A&#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (stepp &gt; <span class="number">1000</span> || stepp &lt; <span class="number">200</span>) &#123;</span><br><span class="line">                  Serial.<span class="built_in">println</span>(<span class="string">&quot;Over/Below Current&quot;</span>);</span><br><span class="line">                  <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">               sd.<span class="built_in">setCurrentMilliamps36v4</span>(stepp);</span><br><span class="line">               Serial.<span class="built_in">print</span>(<span class="string">&quot;The motor current is set to be &quot;</span>);</span><br><span class="line">               Serial.<span class="built_in">print</span>(stepp);</span><br><span class="line">               Serial.<span class="built_in">println</span>(<span class="string">&quot; mA&quot;</span>);</span><br><span class="line">            &#125;    </span><br><span class="line">       <span class="keyword">else</span> <span class="keyword">if</span> (comdata[<span class="number">0</span>] == <span class="string">&#x27;E&#x27;</span>) &#123;</span><br><span class="line">               <span class="keyword">if</span> (<span class="built_in">digitalReadFast</span>(zChannel))&#123;</span><br><span class="line">               Serial.<span class="built_in">println</span>(<span class="string">&quot;High&quot;</span>);</span><br><span class="line">               <span class="built_in">delay</span>(<span class="number">100</span>);</span><br><span class="line">               &#125;</span><br><span class="line">               Serial.<span class="built_in">print</span>(<span class="string">&quot;number of pulses: &quot;</span>);</span><br><span class="line">               Serial.<span class="built_in">println</span>(EncoderTicks);</span><br><span class="line">            &#125;          </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    Serial.<span class="built_in">println</span>(<span class="string">&quot;Error: Command must start with &#x27;+&#x27;, &#x27;-&#x27;, &#x27;A&#x27;, or &#x27;E&#x27;. Please re-enter the command.&quot;</span>);</span><br><span class="line">          <span class="keyword">return</span>;  <span class="comment">// Skip the rest of the loop and wait for new input.</span></span><br><span class="line">           &#125;</span><br><span class="line">    newData = <span class="literal">false</span>;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Sends a pulse on the STEP pin to tell the driver to take one step, and also</span></span><br><span class="line"><span class="comment">//delays to control the speed of the motor.</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">step</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// The STEP minimum high pulse width is 1.9 microseconds.</span></span><br><span class="line">  <span class="built_in">digitalWrite</span>(StepPin, HIGH);</span><br><span class="line">  <span class="built_in">delayMicroseconds</span>(<span class="number">3</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(StepPin, LOW);</span><br><span class="line">  <span class="built_in">delayMicroseconds</span>(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Writes a high or low value to the direction pin to specify what direction to</span></span><br><span class="line"><span class="comment">// turn the motor.</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">setDirection</span><span class="params">(<span class="type">bool</span> dir)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// The STEP pin must not change for at least 200 nanoseconds before and after</span></span><br><span class="line">  <span class="comment">// changing the DIR pin.</span></span><br><span class="line">  <span class="built_in">delayMicroseconds</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">digitalWrite</span>(DirPin, dir);</span><br><span class="line">  <span class="built_in">delayMicroseconds</span>(<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//===============================================================================</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DoSerial</span><span class="params">(<span class="type">char</span> ch, <span class="type">long</span> stepp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="comment">//  char ch = toupper(Serial.read());   // Read the character we received</span></span><br><span class="line"><span class="comment">//  // and convert to upper case</span></span><br><span class="line">  <span class="keyword">switch</span> (ch) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:                        </span><br><span class="line">      <span class="built_in">setDirection</span>(<span class="number">0</span>);</span><br><span class="line"> <span class="keyword">for</span>(<span class="type">unsigned</span> <span class="type">int</span> x = <span class="number">0</span>; x &lt; stepp; x++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">step</span>();</span><br><span class="line">    <span class="built_in">delayMicroseconds</span>(StepPeriodUs);</span><br><span class="line">    <span class="built_in">checkStatus</span>();</span><br><span class="line">  &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">      <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">      <span class="built_in">setDirection</span>(<span class="number">1</span>);</span><br><span class="line"> <span class="keyword">for</span>(<span class="type">unsigned</span> <span class="type">int</span> x = <span class="number">0</span>; x &lt; stepp; x++)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="built_in">step</span>();</span><br><span class="line">    <span class="built_in">delayMicroseconds</span>(StepPeriodUs);</span><br><span class="line">    <span class="built_in">checkStatus</span>();</span><br><span class="line">  &#125;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// ============================================</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">recvWithStartEndMarkers</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="type">static</span> boolean recvInProgress = <span class="literal">false</span>;</span><br><span class="line">    <span class="type">static</span> byte ndx = <span class="number">0</span>;</span><br><span class="line">    <span class="type">char</span> startMarker = <span class="string">&#x27;&lt;&#x27;</span>;</span><br><span class="line">    <span class="type">char</span> endMarker = <span class="string">&#x27;&gt;&#x27;</span>;</span><br><span class="line">    <span class="type">char</span> rc;</span><br><span class="line"> <span class="comment">// if (Serial.available() &gt; 0) &#123;</span></span><br><span class="line">    <span class="keyword">while</span> (Serial.<span class="built_in">available</span>() &gt; <span class="number">0</span> &amp;&amp; newData == <span class="literal">false</span>) &#123;</span><br><span class="line">        rc = Serial.<span class="built_in">read</span>();</span><br><span class="line">        <span class="built_in">delay</span>(<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">if</span> (recvInProgress == <span class="literal">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (rc != endMarker) &#123;</span><br><span class="line">                comdata[ndx] = rc;</span><br><span class="line">                ndx++;</span><br><span class="line">                <span class="keyword">if</span> (ndx &gt;= numChars) &#123;</span><br><span class="line">                    ndx = numChars - <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                comdata[ndx] = <span class="string">&#x27;\0&#x27;</span>; <span class="comment">// terminate the string</span></span><br><span class="line">                recvInProgress = <span class="literal">false</span>;</span><br><span class="line">                ndx = <span class="number">0</span>;</span><br><span class="line">                newData = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (rc == startMarker) &#123;</span><br><span class="line">            recvInProgress = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Interrupt service routines for the quadrature encoder</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">HandleInterruptA</span><span class="params">()</span><span class="comment">//</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="comment">// Test transition; since the interrupt will only fire on &#x27;rising&#x27; we don&#x27;t need to read pin A</span></span><br><span class="line">  EncoderBSet = <span class="built_in">digitalReadFast</span>(EncoderPinB);   <span class="comment">// read the input pin</span></span><br><span class="line">  <span class="comment">// // and adjust counter + if A leads B</span></span><br><span class="line">  <span class="comment">// #ifdef LeftEncoderIsReversed</span></span><br><span class="line">    EncoderTicks -= EncoderBSet ? <span class="number">-1</span> : +<span class="number">1</span>;</span><br><span class="line">  <span class="comment">// #else</span></span><br><span class="line">    <span class="comment">// _LeftEncoderTicks += _LeftEncoderBSet ? -1 : +1;</span></span><br><span class="line">  <span class="comment">// #endif</span></span><br><span class="line">   <span class="type">char</span> i;</span><br><span class="line">   i = <span class="built_in">digitalRead</span>(EncoderPinB);</span><br><span class="line">   <span class="keyword">if</span> (i == <span class="number">1</span>)</span><br><span class="line">   flagA += <span class="number">1</span>;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   flagB += <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">checkStatus</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  motorState = <span class="built_in">digitalRead</span>(FaultPin);</span><br><span class="line">  <span class="built_in">delay</span>(<span class="number">2</span>);</span><br><span class="line">  <span class="keyword">if</span> (motorState == <span class="number">0</span>)&#123;</span><br><span class="line">   Serial.<span class="built_in">println</span>(<span class="string">&quot;Faulty&quot;</span>);</span><br><span class="line">   <span class="built_in">delay</span>(<span class="number">2</span>);</span><br><span class="line">   <span class="built_in">digitalWrite</span>(SleepPin, LOW);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//============================================</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>research</category>
      </categories>
      <tags>
        <tag>Arduino Code</tag>
      </tags>
  </entry>
  <entry>
    <title>Flow Visualisation</title>
    <url>/2024/04/12/flowVisualisation/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p><img src="/2024/04/12/flowVisualisation/noActivation.png" alt="Offset attaching jet flow without activation"></p>
<span id="more"></span> 
<p><img src="/2024/04/12/flowVisualisation/upActivation40Hz.png" alt="Offset attaching jet flow with upper activation of 40 Hz"><br><img src="/2024/04/12/flowVisualisation/upActivation60Hz.png" alt="Offset attaching jet flow with upper activation of 60 Hz"></p>
<p><img src="/2024/04/12/flowVisualisation/offsetAttachingJetWallNormalVelocityNoActivation.jpg" alt="The streamwise velocity for the offset attaching jet flow"></p>
<p><img src="/2024/04/12/flowVisualisation/offsetAttachingJetStreamWiseVelocityNoActivation.jpg" alt="The wall-normal velocity for the offset attaching jet flow"></p>
]]></content>
      <categories>
        <category>research</category>
      </categories>
  </entry>
  <entry>
    <title>Calculator created by MATLAB</title>
    <url>/2024/01/27/calculatorMATLABGUI/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h2 id="This-is-a-MATLAB-GUI-code-for-an-advanced-calculator-with-multiple-functions"><a href="#This-is-a-MATLAB-GUI-code-for-an-advanced-calculator-with-multiple-functions" class="headerlink" title="This is a MATLAB GUI code for an advanced calculator with multiple functions."></a>This is a MATLAB GUI code for an advanced calculator with multiple functions.</h2><span id="more"></span> 

<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">calculatorAdvanced</span></span></span><br><span class="line"><span class="comment">% Create a figure for the calculator</span></span><br><span class="line">h.fig = <span class="built_in">figure</span>(<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;Simple Calculator&#x27;</span>, ...</span><br><span class="line">    <span class="string">&#x27;NumberTitle&#x27;</span>, <span class="string">&#x27;off&#x27;</span>, ...</span><br><span class="line">    <span class="string">&#x27;MenuBar&#x27;</span>, <span class="string">&#x27;none&#x27;</span>, ...</span><br><span class="line">    <span class="string">&#x27;Resize&#x27;</span>, <span class="string">&#x27;off&#x27;</span>, ...</span><br><span class="line">    ...<span class="string">&#x27;Resize&#x27;</span>, <span class="string">&#x27;on&#x27;</span>, ...</span><br><span class="line">    <span class="string">&#x27;Position&#x27;</span>, [<span class="number">800</span>, <span class="number">500</span>, <span class="number">300</span>, <span class="number">330</span>]...       Adjust the position and <span class="built_in">size</span> as needed</span><br><span class="line">    ,<span class="string">&#x27;Alphamap&#x27;</span>,<span class="number">0.2</span> ...</span><br><span class="line">    ,<span class="string">&#x27;Color&#x27;</span>,[<span class="number">0.95</span> <span class="number">0.95</span> <span class="number">0.95</span>]...[<span class="number">87</span> <span class="number">86</span> <span class="number">84</span>]/<span class="number">255</span> ...</span><br><span class="line">    ...,<span class="string">&#x27;Visible&#x27;</span>,<span class="string">&#x27;off&#x27;</span>...</span><br><span class="line">    ,<span class="string">&#x27;WindowKeyPressFcn&#x27;</span>,@keyPressCallback);  <span class="comment">% Listen for key presses</span></span><br><span class="line"></span><br><span class="line">lastOperator = <span class="string">&#x27;&#x27;</span>; <span class="comment">% To store the last operator used</span></span><br><span class="line">lastOperand = <span class="string">&#x27;&#x27;</span>; <span class="comment">% To store the last operand used</span></span><br><span class="line">h.figOriginPosition = h.fig.Position;</span><br><span class="line"></span><br><span class="line"><span class="comment">% Create the main panel</span></span><br><span class="line">h.panel = uipanel(<span class="string">&#x27;Parent&#x27;</span>, h.fig, ...</span><br><span class="line">    <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]);</span><br><span class="line"></span><br><span class="line"><span class="comment">% Add a logo to the main panel</span></span><br><span class="line">logoImage = imread(<span class="string">&#x27;logo.jpg&#x27;</span>); <span class="comment">% Replace &#x27;logo.png&#x27; with the path to your logo image</span></span><br><span class="line">logoAxes = axes(<span class="string">&#x27;Parent&#x27;</span>, h.panel, ...</span><br><span class="line">    <span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;Pixels&#x27;</span>,...</span><br><span class="line">    <span class="string">&#x27;Position&#x27;</span>, [<span class="number">100</span>, <span class="number">150</span>, <span class="number">100</span>, <span class="number">100</span>], ...</span><br><span class="line">    <span class="string">&#x27;Visible&#x27;</span>, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">image(logoImage, <span class="string">&#x27;Parent&#x27;</span>, logoAxes);</span><br><span class="line"><span class="comment">% axis(logoAxes, &#x27;image&#x27;);</span></span><br><span class="line">axis equal</span><br><span class="line">axis off</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">%% Calculator</span></span><br><span class="line"><span class="comment">% Create the button to open the calculator interface</span></span><br><span class="line">h.openButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.panel, ...</span><br><span class="line">    <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">    <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">260</span>, <span class="number">200</span>, <span class="number">40</span>], ...</span><br><span class="line">    <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Open Calculator&#x27;</span>, ...</span><br><span class="line">    <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">    <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">    <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">    <span class="string">&#x27;Callback&#x27;</span>, @openCalculator);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% Callback function for opening the calculator interface</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">openCalculator</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="comment">% Hide the main panel and show the calculator interface</span></span><br><span class="line">        set(h.panel, <span class="string">&#x27;Visible&#x27;</span>, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">        set(h.fig, <span class="string">&#x27;Color&#x27;</span>, <span class="string">&#x27;white&#x27;</span>);</span><br><span class="line">        <span class="comment">%         set(h.fig, &#x27;WindowKeyPressFcn&#x27;, @calculatorKeyPressCallback);</span></span><br><span class="line">        <span class="comment">% Create the calculator interface</span></span><br><span class="line">        createCalculatorInterface();</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% Create the calculator interface</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createCalculatorInterface</span><span class="params">()</span></span></span><br><span class="line">        <span class="comment">% Create a panel for the calculator interface</span></span><br><span class="line">        h.calculatorPanel = uipanel(<span class="string">&#x27;Parent&#x27;</span>, h.fig, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]);</span><br><span class="line">        <span class="comment">% Display for the calculator</span></span><br><span class="line">        h.display = uicontrol(<span class="string">&#x27;Parent&#x27;</span>,h.calculatorPanel,<span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;edit&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">60</span>+<span class="number">30</span>, <span class="number">245</span>, <span class="number">280</span><span class="number">-80</span>, <span class="number">30</span>], ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">18</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>], ...[<span class="number">46</span> <span class="number">45</span> <span class="number">36</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;HorizontalAlignment&#x27;</span>, <span class="string">&#x27;right&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>,[<span class="number">0.1</span> <span class="number">0.1</span> <span class="number">0.1</span>],...</span><br><span class="line">            <span class="string">&#x27;FontWeight&#x27;</span>,<span class="string">&#x27;Bold&#x27;</span>,...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        h.display2 = uicontrol(<span class="string">&#x27;Parent&#x27;</span>,h.calculatorPanel,<span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;edit&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">60</span>+<span class="number">30</span>, <span class="number">278</span>, <span class="number">280</span><span class="number">-80</span>, <span class="number">40</span>], ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">12</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>], ...[<span class="number">46</span> <span class="number">45</span> <span class="number">36</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;HorizontalAlignment&#x27;</span>, <span class="string">&#x27;right&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>,[<span class="number">0.3</span> <span class="number">0.3</span> <span class="number">0.3</span>],...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Button size and padding</span></span><br><span class="line">        btnSize = [<span class="number">50</span>, <span class="number">40</span>]; <span class="comment">% Width, height</span></span><br><span class="line">        padding = [<span class="number">7</span>, <span class="number">7</span>]; <span class="comment">% Padding between buttons</span></span><br><span class="line">        startPos = [<span class="number">10</span>, <span class="number">200</span>]; <span class="comment">% Starting position of the first button</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Button labels</span></span><br><span class="line">        <span class="comment">%     btns = &#123;&#x27;7&#x27;, &#x27;8&#x27;, &#x27;9&#x27;, &#x27;+&#x27;, &#x27;C&#x27;; ...</span></span><br><span class="line">        <span class="comment">%             &#x27;4&#x27;, &#x27;5&#x27;, &#x27;6&#x27;, &#x27;-&#x27;, &#x27;CE&#x27;; ...</span></span><br><span class="line">        <span class="comment">%             &#x27;1&#x27;, &#x27;2&#x27;, &#x27;3&#x27;, &#x27;*&#x27;, &#x27;=&#x27;; ...</span></span><br><span class="line">        <span class="comment">%             &#x27;0&#x27;, &#x27;&#x27;, &#x27;.&#x27;, &#x27;/&#x27;, &#x27;&#x27;&#125;;</span></span><br><span class="line">        btns = &#123;char(<span class="number">9003</span>), <span class="string">&#x27;CE&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, char(<span class="number">177</span>), char(<span class="number">8730</span>); ...</span><br><span class="line">            <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;%&#x27;</span>; ...</span><br><span class="line">            <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;1/x&#x27;</span>; ...</span><br><span class="line">            <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;=&#x27;</span>;...</span><br><span class="line">            <span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;.&#x27;</span>,<span class="string">&#x27;+&#x27;</span>,<span class="string">&#x27;&#x27;</span>&#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create the buttons in a grid</span></span><br><span class="line">        numRows = <span class="built_in">size</span>(btns, <span class="number">1</span>);</span><br><span class="line">        numCols = <span class="built_in">size</span>(btns, <span class="number">2</span>);</span><br><span class="line">        h.btn = <span class="built_in">zeros</span>(numRows, numCols);</span><br><span class="line">        <span class="keyword">for</span> row = <span class="number">1</span>:numRows</span><br><span class="line">            <span class="keyword">for</span> col = <span class="number">1</span>:numCols</span><br><span class="line">                btnVal = btns&#123;row, col&#125;;</span><br><span class="line">                <span class="keyword">if</span> ~<span class="built_in">isempty</span>(btnVal)</span><br><span class="line">                    btnWidth = btnSize(<span class="number">1</span>);</span><br><span class="line">                    btnHeight = btnSize(<span class="number">2</span>);</span><br><span class="line">                    <span class="comment">% Adjust &#x27;=&#x27; button to span two rows</span></span><br><span class="line">                    <span class="keyword">if</span> strcmp(btnVal, <span class="string">&#x27;=&#x27;</span>)</span><br><span class="line">                        btnHeight = btnHeight * <span class="number">2</span> + padding(<span class="number">2</span>);</span><br><span class="line">                        btnPosition = [startPos(<span class="number">1</span>) + (col - <span class="number">1</span>) * (btnSize(<span class="number">1</span>) + padding(<span class="number">1</span>)), ...</span><br><span class="line">                            startPos(<span class="number">2</span>) - (row - <span class="number">1</span>) * (btnSize(<span class="number">2</span>) + padding(<span class="number">2</span>)) - padding(<span class="number">2</span>) - btnSize(<span class="number">2</span>), ...</span><br><span class="line">                            btnWidth, btnHeight];</span><br><span class="line">                    <span class="keyword">elseif</span> strcmp(btnVal, <span class="string">&#x27;0&#x27;</span>)</span><br><span class="line">                        btnWidth = btnWidth * <span class="number">2</span> + padding(<span class="number">1</span>);</span><br><span class="line">                        btnPosition = [startPos(<span class="number">1</span>) + (col - <span class="number">1</span>) * (btnSize(<span class="number">1</span>) + padding(<span class="number">1</span>)), ...</span><br><span class="line">                            startPos(<span class="number">2</span>) - (row - <span class="number">1</span>) * (btnSize(<span class="number">2</span>) + padding(<span class="number">2</span>)) ...</span><br><span class="line">                            btnWidth, btnHeight];</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        btnPosition = [startPos(<span class="number">1</span>) + (col - <span class="number">1</span>) * (btnSize(<span class="number">1</span>) + padding(<span class="number">1</span>)), ...</span><br><span class="line">                            startPos(<span class="number">2</span>) - (row - <span class="number">1</span>) * (btnSize(<span class="number">2</span>) + padding(<span class="number">2</span>)), ...</span><br><span class="line">                            btnWidth, btnHeight];</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    </span><br><span class="line">                    h.btn(row, col) = uicontrol(<span class="string">&#x27;Parent&#x27;</span>,h.calculatorPanel,<span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">                        <span class="string">&#x27;Position&#x27;</span>, btnPosition, ...</span><br><span class="line">                        <span class="string">&#x27;String&#x27;</span>, btnVal, ...</span><br><span class="line">                        <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">16</span>, ...</span><br><span class="line">                        <span class="string">&#x27;BackgroundColor&#x27;</span>,[<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">                        <span class="string">&#x27;ForegroundColor&#x27;</span>,[<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>,...</span><br><span class="line">                        <span class="string">&#x27;Callback&#x27;</span>, &#123;@btnCallback, btnVal&#125;);</span><br><span class="line">                    </span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create the button to return to the main panel</span></span><br><span class="line">        h.returnButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.calculatorPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">10</span> <span class="number">245</span> <span class="number">80</span> <span class="number">60</span>], ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Return&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;Callback&#x27;</span>, @returnToMainPanel);</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Callback function for button clicks</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">btnCallback</span><span class="params">(src, ~, btnVal)</span></span></span><br><span class="line">        current = get(h.display2, <span class="string">&#x27;String&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">switch</span> btnVal</span><br><span class="line">            <span class="keyword">case</span> &#123;<span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;/&#x27;</span>&#125;</span><br><span class="line">                <span class="comment">% Do not add an operator if the string is empty or already ends with an operator</span></span><br><span class="line">                <span class="keyword">if</span> ~<span class="built_in">isempty</span>(current)<span class="comment">% &amp;&amp; ~any(current(end) == &#x27;+-*/&#x27;)</span></span><br><span class="line">                    set(h.display2, <span class="string">&#x27;String&#x27;</span>, [current btnVal]);</span><br><span class="line">                    <span class="comment">%                     result = eval(current);</span></span><br><span class="line">                    <span class="comment">%                     set(h.display, &#x27;String&#x27;, num2str(result));</span></span><br><span class="line">                    <span class="comment">%                     set(h.display2, &#x27;String&#x27;, result);</span></span><br><span class="line">                    <span class="keyword">if</span> any(current(<span class="keyword">end</span>) == <span class="string">&#x27;+-*/&#x27;</span>)</span><br><span class="line">                        set(h.display2, <span class="string">&#x27;String&#x27;</span>, [current(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>) btnVal]);</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;CE&#x27;</span></span><br><span class="line">                <span class="comment">% Clear the last entry</span></span><br><span class="line">                <span class="keyword">if</span> ~<span class="built_in">isempty</span>(current)</span><br><span class="line">                    set(h.display2, <span class="string">&#x27;String&#x27;</span>, current(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>));</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;=&#x27;</span></span><br><span class="line">                <span class="comment">% Calculate the result or repeat the last operation</span></span><br><span class="line">                <span class="keyword">if</span> <span class="built_in">isempty</span>(lastOperator) || <span class="built_in">isempty</span>(lastOperand)</span><br><span class="line">                    <span class="comment">% If there&#x27;s no last operation, perform the current calculation</span></span><br><span class="line">                    <span class="keyword">try</span></span><br><span class="line">                        result = eval(current);</span><br><span class="line">                        set(h.display, <span class="string">&#x27;String&#x27;</span>, num2str(result));</span><br><span class="line">                        <span class="comment">% Store the last operand and operator for repeated &quot;=&quot; presses</span></span><br><span class="line">                        tokens = regexp(current, <span class="string">&#x27;(.*?)([\+\-\*\/])(\d+\.?\d*)$&#x27;</span>, <span class="string">&#x27;tokens&#x27;</span>);</span><br><span class="line">                        <span class="keyword">if</span> ~<span class="built_in">isempty</span>(tokens)</span><br><span class="line">                            lastOperator = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">2</span>&#125;;</span><br><span class="line">                            lastOperand = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">3</span>&#125;;</span><br><span class="line">                        <span class="keyword">end</span></span><br><span class="line">                    <span class="keyword">catch</span></span><br><span class="line">                        <span class="comment">% If there&#x27;s an error in evaluation, display an error message</span></span><br><span class="line">                        set(h.display, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Error&#x27;</span>);</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="comment">% If there&#x27;s a last operation, repeat it with the current result</span></span><br><span class="line">                    <span class="keyword">try</span></span><br><span class="line">                        <span class="comment">% Get the current result to use as the first operand</span></span><br><span class="line">                        currentResult = get(h.display, <span class="string">&#x27;String&#x27;</span>);</span><br><span class="line">                        <span class="comment">% Repeat the operation using the last operand and operator</span></span><br><span class="line">                        newExpression = [currentResult lastOperator lastOperand];</span><br><span class="line">                        result = eval(newExpression);</span><br><span class="line">                        set(h.display, <span class="string">&#x27;String&#x27;</span>, num2str(result));</span><br><span class="line">                        set(h.display2,<span class="string">&#x27;String&#x27;</span>,[get(h.display2, <span class="string">&#x27;String&#x27;</span>) lastOperator lastOperand])</span><br><span class="line">                    <span class="keyword">catch</span></span><br><span class="line">                        <span class="comment">% If there&#x27;s an error, clear last operation and display an error message</span></span><br><span class="line">                        lastOperator = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                        lastOperand = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                        set(h.display, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Error&#x27;</span>);</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                <span class="comment">% Clear the last operation if &#x27;C&#x27; is pressed</span></span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;C&#x27;</span></span><br><span class="line">                lastOperator = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                lastOperand = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">                set(h.display, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">                set(h.display2, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">            <span class="keyword">case</span> char(<span class="number">9003</span>)</span><br><span class="line">                <span class="comment">% Delete the last character</span></span><br><span class="line">                <span class="keyword">if</span> ~<span class="built_in">isempty</span>(current)</span><br><span class="line">                    set(h.display2, <span class="string">&#x27;String&#x27;</span>, current(<span class="number">1</span>:<span class="keyword">end</span><span class="number">-1</span>));</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">case</span> char(<span class="number">177</span>)</span><br><span class="line">                <span class="comment">% Plus-minus (change sign)</span></span><br><span class="line">                tokens = regexp(current, <span class="string">&#x27;(.*?)([\+\-\*\/]|^)(\d+\.?\d*)$&#x27;</span>, <span class="string">&#x27;tokens&#x27;</span>);</span><br><span class="line">                <span class="keyword">if</span> ~<span class="built_in">isempty</span>(tokens)</span><br><span class="line">                    <span class="comment">% tokens&#123;1&#125; should be a cell with the parts: &#123;before, operator, number&#125;</span></span><br><span class="line">                    before = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">1</span>&#125;;</span><br><span class="line">                    operator = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">2</span>&#125;;</span><br><span class="line">                    lastNum = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">3</span>&#125;;</span><br><span class="line">                    </span><br><span class="line">                    <span class="keyword">if</span> <span class="built_in">isempty</span>(operator)</span><br><span class="line">                        operator = <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">                    <span class="keyword">elseif</span> strcmp(operator(<span class="keyword">end</span>),<span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">                        operator(<span class="keyword">end</span>) = <span class="string">&#x27;+&#x27;</span>;</span><br><span class="line">                    <span class="keyword">elseif</span> strcmp(operator(<span class="keyword">end</span>),<span class="string">&#x27;+&#x27;</span>)</span><br><span class="line">                        operator(<span class="keyword">end</span>) = <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">                        </span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">% Reconstruct the display string</span></span><br><span class="line">                    newDisplay = [before, operator, lastNum];</span><br><span class="line">                    set(h.display2, <span class="string">&#x27;String&#x27;</span>, newDisplay);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">case</span> char(<span class="number">8730</span>)</span><br><span class="line">                tokens = regexp(current, <span class="string">&#x27;(.*?)([\+\-\*\/]|^)(\d+\.?\d*)$&#x27;</span>, <span class="string">&#x27;tokens&#x27;</span>);</span><br><span class="line">                <span class="keyword">if</span> ~<span class="built_in">isempty</span>(tokens)</span><br><span class="line">                    <span class="comment">% tokens&#123;1&#125; should be a cell with the parts: &#123;before, operator, number&#125;</span></span><br><span class="line">                    before = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">1</span>&#125;;operator = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">2</span>&#125;;lastNum = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">3</span>&#125;;</span><br><span class="line">                    <span class="comment">% Take the square root of the last number</span></span><br><span class="line">                    sqrtLastNum = num2str(<span class="built_in">sqrt</span>(str2double(lastNum)));</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">% Reconstruct the display string</span></span><br><span class="line">                    newDisplay = [before, operator, sqrtLastNum];</span><br><span class="line">                    set(h.display2, <span class="string">&#x27;String&#x27;</span>, newDisplay);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                </span><br><span class="line">            <span class="keyword">case</span> <span class="string">&#x27;%&#x27;</span></span><br><span class="line">                tokens = regexp(current, <span class="string">&#x27;(.*?)([\+\-\*\/]|^)(\d+\.?\d*)$&#x27;</span>, <span class="string">&#x27;tokens&#x27;</span>);</span><br><span class="line">                <span class="keyword">if</span> ~<span class="built_in">isempty</span>(tokens)</span><br><span class="line">                    <span class="comment">% tokens&#123;1&#125; should be a cell with the parts: &#123;before, operator, number&#125;</span></span><br><span class="line">                    before = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">1</span>&#125;;operator = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">2</span>&#125;;lastNum = tokens&#123;<span class="number">1</span>&#125;&#123;<span class="number">3</span>&#125;;</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">% Take the square root of the last number</span></span><br><span class="line">                    sqrtLastNum = num2str(str2double(lastNum)*<span class="number">0.01</span>);</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">% Reconstruct the display string</span></span><br><span class="line">                    newDisplay = [before, operator, sqrtLastNum];</span><br><span class="line">                    set(h.display2, <span class="string">&#x27;String&#x27;</span>, newDisplay);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">otherwise</span></span><br><span class="line">                <span class="comment">% For numbers and decimal point, append to the display</span></span><br><span class="line">                set(h.display2, <span class="string">&#x27;String&#x27;</span>, [current btnVal]);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        set(src, <span class="string">&#x27;enable&#x27;</span>, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">        drawnow;</span><br><span class="line">        set(src, <span class="string">&#x27;enable&#x27;</span>, <span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% Key press callback function</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">keyPressCallback</span><span class="params">(~, event)</span></span></span><br><span class="line">        <span class="comment">% Mapping from key names to button labels</span></span><br><span class="line">        keyToButtonMap = containers.Map(...</span><br><span class="line">            &#123;<span class="string">&#x27;numpad0&#x27;</span>, <span class="string">&#x27;numpad1&#x27;</span>, <span class="string">&#x27;numpad2&#x27;</span>, <span class="string">&#x27;numpad3&#x27;</span>, <span class="string">&#x27;numpad4&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;numpad5&#x27;</span>, <span class="string">&#x27;numpad6&#x27;</span>, <span class="string">&#x27;numpad7&#x27;</span>, <span class="string">&#x27;numpad8&#x27;</span>, <span class="string">&#x27;numpad9&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;add&#x27;</span>, <span class="string">&#x27;plus&#x27;</span>, <span class="string">&#x27;subtract&#x27;</span>, <span class="string">&#x27;minus&#x27;</span>, <span class="string">&#x27;multiply&#x27;</span>, <span class="string">&#x27;divide&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;decimal&#x27;</span>, <span class="string">&#x27;period&#x27;</span>, <span class="string">&#x27;return&#x27;</span>, <span class="string">&#x27;equal&#x27;</span>,<span class="string">&#x27;enter&#x27;</span> ,<span class="string">&#x27;escape&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;backspace&#x27;</span>, <span class="string">&#x27;ce&#x27;</span>&#125;, ...</span><br><span class="line">            &#123;<span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;0&#x27;</span>, <span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;3&#x27;</span>, <span class="string">&#x27;4&#x27;</span>, <span class="string">&#x27;5&#x27;</span>, <span class="string">&#x27;6&#x27;</span>, <span class="string">&#x27;7&#x27;</span>, <span class="string">&#x27;8&#x27;</span>, <span class="string">&#x27;9&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;+&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;-&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;=&#x27;</span>, <span class="string">&#x27;=&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;CE&#x27;</span>, <span class="string">&#x27;CE&#x27;</span>&#125;);</span><br><span class="line">        <span class="comment">% Get the button label from the map if it exists</span></span><br><span class="line">        <span class="keyword">if</span> keyToButtonMap.isKey(event.Key)</span><br><span class="line">            btnVal = keyToButtonMap(event.Key);</span><br><span class="line">            btnCallback([], [], btnVal); <span class="comment">% Call the button callback directly</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">%% Word Lookup</span></span><br><span class="line"><span class="comment">% Create the button to open the English word lookup interface</span></span><br><span class="line">h.wordButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.panel, ...</span><br><span class="line">    <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">    <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">100</span>, <span class="number">200</span>, <span class="number">40</span>], ...</span><br><span class="line">    <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;English Word Lookup&#x27;</span>, ...</span><br><span class="line">    <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">    <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">    <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">    <span class="string">&#x27;Callback&#x27;</span>, @openWordLookupInterface);</span><br><span class="line"><span class="comment">% Callback function for opening the English word lookup interface</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">openWordLookupInterface</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="comment">% Hide the main panel and show the word lookup interface</span></span><br><span class="line">        set(h.panel, <span class="string">&#x27;Visible&#x27;</span>, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">        set(h.fig, <span class="string">&#x27;Color&#x27;</span>, <span class="string">&#x27;white&#x27;</span>);</span><br><span class="line">        set(h.fig, <span class="string">&#x27;WindowKeyPressFcn&#x27;</span>, @wordLookupKeyPressCallback);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create the word lookup interface</span></span><br><span class="line">        createWordLookupInterface();</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Create the word lookup interface</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createWordLookupInterface</span><span class="params">()</span></span></span><br><span class="line">        <span class="comment">% Create a panel for the word lookup interface</span></span><br><span class="line">        h.wordLookupPanel = uipanel(<span class="string">&#x27;Parent&#x27;</span>, h.fig, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create a button to return to the main panel</span></span><br><span class="line">        h.returnButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.wordLookupPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">50</span>, <span class="number">200</span>, <span class="number">40</span>], ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Return to Main Panel&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;Callback&#x27;</span>, @returnToMainPanel);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create a button to select an Excel file and load the data</span></span><br><span class="line">        h.selectButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.wordLookupPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">100</span>, <span class="number">200</span>, <span class="number">40</span>], ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Select Excel File&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;Callback&#x27;</span>, @selectExcelFile);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create an edit box for typing English words</span></span><br><span class="line">        h.editEnglish = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.wordLookupPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;edit&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">180</span>, <span class="number">200</span>, <span class="number">30</span>], ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>], ...</span><br><span class="line">            <span class="string">&#x27;HorizontalAlignment&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Callback&#x27;</span>, @lookupTranslation);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">%     h.displayEnglish = uicontrol(&#x27;Parent&#x27;, h.wordLookupPanel, ...</span></span><br><span class="line">        <span class="comment">%         &#x27;Style&#x27;, &#x27;text&#x27;, ...</span></span><br><span class="line">        <span class="comment">%         &#x27;Position&#x27;, [50, 180, 60, 30], ...</span></span><br><span class="line">        <span class="comment">%         &#x27;FontSize&#x27;, 14, ...</span></span><br><span class="line">        <span class="comment">%         &#x27;BackgroundColor&#x27;,&#x27;none&#x27;, ...</span></span><br><span class="line">        <span class="comment">%         &#x27;HorizontalAlignment&#x27;, &#x27;left&#x27;, ...</span></span><br><span class="line">        <span class="comment">%         &#x27;String&#x27;, &#x27;English&#x27;, ...</span></span><br><span class="line">        <span class="comment">%         &#x27;Callback&#x27;, @lookupTranslation);</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Set the key press callback function for the edit box</span></span><br><span class="line">        set(h.editEnglish, <span class="string">&#x27;KeyPressFcn&#x27;</span>, @wordLookupKeyPressCallback);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create a text box for displaying corresponding Chinese translations</span></span><br><span class="line">        h.textChinese = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.wordLookupPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;text&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">220</span>, <span class="number">200</span>, <span class="number">30</span>], ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">1</span> <span class="number">1</span> <span class="number">1</span>], ...</span><br><span class="line">            <span class="string">&#x27;HorizontalAlignment&#x27;</span>, <span class="string">&#x27;left&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create a button to trigger the lookup operation</span></span><br><span class="line">        h.lookupButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.wordLookupPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">260</span>, <span class="number">60</span>, <span class="number">40</span>], ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Lookup&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;Callback&#x27;</span>, @lookupButtonCallback);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Callback function for selecting an Excel file and loading the data</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">selectExcelFile</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="comment">% Prompt the user to select an Excel file</span></span><br><span class="line">        [fileName, pathName] = uigetfile(<span class="string">&#x27;*.xlsx&#x27;</span>, <span class="string">&#x27;Select Excel File&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Check if the user clicked Cancel</span></span><br><span class="line">        <span class="keyword">if</span> fileName == <span class="number">0</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Construct the full file path</span></span><br><span class="line">        filePath = fullfile(pathName, fileName);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Read the Excel file</span></span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">            dataTable = readcell(filePath);</span><br><span class="line">            h.data = dataTable(:,<span class="number">1</span>:<span class="number">2</span>);</span><br><span class="line">        <span class="keyword">catch</span> ME</span><br><span class="line">            errordlg(<span class="string">&#x27;Error reading Excel file.&#x27;</span>, <span class="string">&#x27;Error&#x27;</span>, <span class="string">&#x27;modal&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="comment">% Callback function for looking up the translation</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">lookupTranslation</span><span class="params">(src, ~)</span></span></span><br><span class="line">        englishWord = string(get(src, <span class="string">&#x27;String&#x27;</span>));</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Check if the loaded data is empty or not</span></span><br><span class="line">        <span class="keyword">if</span> ~isfield(h,<span class="string">&#x27;data&#x27;</span>)</span><br><span class="line">            set(h.textChinese, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;No Dictionary Loaded&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Find the corresponding translation in the loaded data</span></span><br><span class="line">        <span class="comment">% (Assuming the first column contains English words and the second column contains Chinese translations)</span></span><br><span class="line">        englishColumn = string(h.data(:, <span class="number">1</span>));</span><br><span class="line">        [~, idx] = <span class="built_in">ismember</span>(englishWord, englishColumn);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> idx &gt; <span class="number">0</span></span><br><span class="line">            chineseTranslation = h.data(idx, <span class="number">2</span>);</span><br><span class="line">            set(h.textChinese, <span class="string">&#x27;String&#x27;</span>, chineseTranslation&#123;<span class="number">1</span>&#125;);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            set(h.textChinese, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Translation not found&#x27;</span>);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Callback function for the lookup button</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">lookupButtonCallback</span><span class="params">(~, ~)</span></span></span><br><span class="line">        lookupTranslation(h.editEnglish);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% Key press callback function for the word lookup interface</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">wordLookupKeyPressCallback</span><span class="params">(~, event)</span></span></span><br><span class="line">        <span class="comment">% Get the key value from the event</span></span><br><span class="line">        keyValue = event.Key;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Check if the key value is &#x27;return&#x27; or &#x27;enter&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> strcmpi(keyValue, <span class="string">&#x27;return&#x27;</span>) || strcmpi(keyValue, <span class="string">&#x27;enter&#x27;</span>)</span><br><span class="line">            lookupTranslation(h.editEnglish);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">%% Stock Market</span></span><br><span class="line"><span class="comment">%%% Stock Market Interface %%%</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Create the button to open the Stock Market interface</span></span><br><span class="line">h.StockButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.panel, ...</span><br><span class="line">    <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">    <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">40</span>, <span class="number">200</span>, <span class="number">40</span>], ...</span><br><span class="line">    <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Stock Market&#x27;</span>, ...</span><br><span class="line">    <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">    <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">    <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">    <span class="string">&#x27;Callback&#x27;</span>, @openStockMarketInterface);</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">openStockMarketInterface</span><span class="params">(~, ~)</span></span></span><br><span class="line">        set(h.panel, <span class="string">&#x27;Visible&#x27;</span>, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">        set(h.fig, <span class="string">&#x27;Color&#x27;</span>, <span class="string">&#x27;white&#x27;</span>);</span><br><span class="line">        <span class="comment">%  set(h.fig, &#x27;WindowKeyPressFcn&#x27;, @wordLookupKeyPressCallback);</span></span><br><span class="line">        createStockMarketInterface();</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Create the word lookup interface</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createStockMarketInterface</span><span class="params">()</span></span></span><br><span class="line">        <span class="comment">% Create a panel for the interface</span></span><br><span class="line">        </span><br><span class="line">        h.fig.Position = [<span class="number">300</span> <span class="number">400</span> <span class="number">500</span> <span class="number">600</span>];</span><br><span class="line">        h.StockMarketPanel = uipanel(<span class="string">&#x27;Parent&#x27;</span>, h.fig, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>]);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create a button to return to the main panel</span></span><br><span class="line">        h.returnButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.StockMarketPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">30</span>], ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Return to Main Panel&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;Callback&#x27;</span>, @returnToMainPanel);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        h.webSite = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.StockMarketPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;text&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">105</span>, <span class="number">545</span>, <span class="number">300</span>, <span class="number">40</span>], ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;搜狐证券上证指数历史数据爬取&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span> ..., ...</span><br><span class="line">            ...    <span class="string">&#x27;Callback&#x27;</span>, @selectExcelFile</span><br><span class="line">            );</span><br><span class="line">        </span><br><span class="line">        h.webButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.StockMarketPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">50</span>, <span class="number">180</span>, <span class="number">30</span>], ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Crawl a website&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;Callback&#x27;</span>, @getWebData);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create a table within the figure</span></span><br><span class="line">        columnNames = &#123;<span class="string">&#x27;日期&#x27;</span>, <span class="string">&#x27;开盘价&#x27;</span>, <span class="string">&#x27;收盘价&#x27;</span>, <span class="string">&#x27;最低价&#x27;</span>, <span class="string">&#x27;最高价&#x27;</span>&#125;;</span><br><span class="line">        h.webTable = uitable(<span class="string">&#x27;Parent&#x27;</span>,h.StockMarketPanel, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">50</span>, <span class="number">100</span>, <span class="number">420</span>, <span class="number">450</span>], <span class="string">&#x27;ColumnName&#x27;</span>, columnNames);</span><br><span class="line">        <span class="comment">% Store the table handle in the button&#x27;s UserData for later access in the callback</span></span><br><span class="line">        h.webButton.UserData = h.webTable;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Button to export table data to Excel</span></span><br><span class="line">        h.exportExcelButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.StockMarketPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">300</span>, <span class="number">50</span>, <span class="number">180</span>, <span class="number">30</span>], ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Export to Excel&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;Callback&#x27;</span>, @exportToExcel);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Button to export table data to TXT</span></span><br><span class="line">        h.exportTxtButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.StockMarketPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">300</span>, <span class="number">10</span>, <span class="number">180</span>, <span class="number">30</span>], ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Export to TXT&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;Callback&#x27;</span>, @exportToTxt);</span><br><span class="line">        </span><br><span class="line">        h.webPlottingPanel = uipanel(<span class="string">&#x27;Parent&#x27;</span>,h.StockMarketPanel,<span class="string">&#x27;Units&#x27;</span>,h.webTable.Units,<span class="string">&#x27;Position&#x27;</span>, h.webTable.Position);</span><br><span class="line">        </span><br><span class="line">        h.webPlottingPanel.Visible = <span class="string">&#x27;off&#x27;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Button to plot table data </span></span><br><span class="line">        h.plotToggleButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.StockMarketPanel, ...</span><br><span class="line">            <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;Position&#x27;</span>, [<span class="number">10</span>, <span class="number">558</span>, <span class="number">60</span>, <span class="number">30</span>], ...</span><br><span class="line">            <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Plot&#x27;</span>, ...</span><br><span class="line">            <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">            <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">            <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">            <span class="string">&#x27;Callback&#x27;</span>, @createToggleButton);</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">historicalStructArray</span> = <span class="title">getWebData</span><span class="params">(src, ~)</span></span></span><br><span class="line">        h.webTable = src.UserData;</span><br><span class="line">        url = <span class="string">&#x27;https://q.stock.sohu.com/hisHq?code=zs_000001&amp;stat=1&amp;order=D&amp;period=d&amp;callback=historySearchHandler&amp;rt=jsonp&amp;0.41374664091573843&#x27;</span>;</span><br><span class="line">        jsonpStr = webread(url);</span><br><span class="line">        <span class="comment">% Use regexprep to remove the padding around the JSON object</span></span><br><span class="line">        jsonStr = regexprep(jsonpStr, <span class="string">&#x27;^[^(]*\((.*)\)[^)]*$&#x27;</span>, <span class="string">&#x27;$1&#x27;</span>);</span><br><span class="line">        <span class="comment">% Parse the JSON string into a MATLAB structure</span></span><br><span class="line">        data1 = jsondecode(jsonStr);</span><br><span class="line">        <span class="comment">% Access the &#x27;hq&#x27; data which contains historical stock data</span></span><br><span class="line">        historicalData = data1.hq;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Now process `historicalData` as needed.</span></span><br><span class="line">        <span class="comment">% Initialize an empty struct array with the fields you mentioned</span></span><br><span class="line">        historicalStructArray = struct(<span class="string">&#x27;date&#x27;</span>, &#123;&#125;, <span class="string">&#x27;openPrice&#x27;</span>, &#123;&#125;, <span class="string">&#x27;closePrice&#x27;</span>, &#123;&#125;, ...</span><br><span class="line">            <span class="string">&#x27;priceChange&#x27;</span>, &#123;&#125;, <span class="string">&#x27;percentChange&#x27;</span>, &#123;&#125;, <span class="string">&#x27;lowPrice&#x27;</span>, &#123;&#125;, ...</span><br><span class="line">            <span class="string">&#x27;highPrice&#x27;</span>, &#123;&#125;, <span class="string">&#x27;volume&#x27;</span>, &#123;&#125;, <span class="string">&#x27;anotherFinancialFigure&#x27;</span>, &#123;&#125;, <span class="string">&#x27;placeholder&#x27;</span>, &#123;&#125;);</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(historicalData)</span><br><span class="line">            <span class="comment">% Assign each field from the cell array to the corresponding field in the struct</span></span><br><span class="line">            historicalStructArray(<span class="built_in">i</span>).date = historicalData&#123;<span class="built_in">i</span>&#125;&#123;<span class="number">1</span>&#125;;</span><br><span class="line">            historicalStructArray(<span class="built_in">i</span>).openPrice = historicalData&#123;<span class="built_in">i</span>&#125;&#123;<span class="number">2</span>&#125;;</span><br><span class="line">            historicalStructArray(<span class="built_in">i</span>).closePrice = historicalData&#123;<span class="built_in">i</span>&#125;&#123;<span class="number">3</span>&#125;;</span><br><span class="line">            historicalStructArray(<span class="built_in">i</span>).priceChange = historicalData&#123;<span class="built_in">i</span>&#125;&#123;<span class="number">4</span>&#125;;</span><br><span class="line">            historicalStructArray(<span class="built_in">i</span>).percentChange = historicalData&#123;<span class="built_in">i</span>&#125;&#123;<span class="number">5</span>&#125;;</span><br><span class="line">            historicalStructArray(<span class="built_in">i</span>).lowPrice = historicalData&#123;<span class="built_in">i</span>&#125;&#123;<span class="number">6</span>&#125;;</span><br><span class="line">            historicalStructArray(<span class="built_in">i</span>).highPrice = historicalData&#123;<span class="built_in">i</span>&#125;&#123;<span class="number">7</span>&#125;;</span><br><span class="line">            historicalStructArray(<span class="built_in">i</span>).volume = historicalData&#123;<span class="built_in">i</span>&#125;&#123;<span class="number">8</span>&#125;;</span><br><span class="line">            <span class="comment">%     historicalStructArray(i).anotherFinancialFigure = historicalData&#123;i&#125;&#123;9&#125;;</span></span><br><span class="line">            <span class="comment">%     historicalStructArray(i).placeholder = historicalData&#123;i&#125;&#123;10&#125;; % Assuming there is a 10th field for placeholder</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        tableData = &#123;historicalStructArray.date; historicalStructArray.openPrice; ...</span><br><span class="line">            historicalStructArray.closePrice; historicalStructArray.lowPrice; ...</span><br><span class="line">            historicalStructArray.highPrice&#125;&#x27;;</span><br><span class="line">        <span class="comment">% Update the table with the new data</span></span><br><span class="line">        set(h.webTable, <span class="string">&#x27;Data&#x27;</span>, tableData);</span><br><span class="line">        <span class="comment">% Adjust column width based on the data</span></span><br><span class="line">        set(h.webTable, <span class="string">&#x27;ColumnWidth&#x27;</span>, &#123;<span class="number">100</span>, <span class="number">80</span>, <span class="number">80</span>, <span class="number">80</span>, <span class="number">80</span>&#125;);</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% create a toggle for plotting</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">createToggleButton</span><span class="params">(~,~)</span></span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isempty</span>(h.webTable.Data)</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> isfield(h,<span class="string">&#x27;ax&#x27;</span>) &amp;&amp; isfield(h,<span class="string">&#x27;webPlottingPanel&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> strcmp(h.webPlottingPanel.Visible, <span class="string">&#x27;on&#x27;</span>)</span><br><span class="line">                h.webPlottingPanel.Visible = <span class="string">&#x27;off&#x27;</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                h.webPlottingPanel.Visible = <span class="string">&#x27;on&#x27;</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">%              h.figwebData = figure(&#x27;NumberTitle&#x27;,&#x27;off&#x27;,  &#x27;MenuBar&#x27;, &#x27;none&#x27;, ...</span></span><br><span class="line">            <span class="comment">%                                              &#x27;Resize&#x27;, &#x27;off&#x27;, ...</span></span><br><span class="line">            <span class="comment">%                                              ...&#x27;Resize&#x27;, &#x27;on&#x27;, ...</span></span><br><span class="line">            <span class="comment">%                                              &#x27;Position&#x27;, h.webTable.Position...       Adjust the position and size as needed</span></span><br><span class="line">            <span class="comment">%                                             ,&#x27;Alphamap&#x27;,0.2 ...</span></span><br><span class="line">            <span class="comment">%                                             ,&#x27;Color&#x27;,[0.95 0.95 0.95],&#x27;Parent&#x27;);</span></span><br><span class="line">            h.webPlottingPanel.Visible = <span class="string">&#x27;on&#x27;</span>;</span><br><span class="line">            h.ax = axes(<span class="string">&#x27;Parent&#x27;</span>,h.webPlottingPanel,<span class="string">&#x27;box&#x27;</span>,<span class="string">&#x27;on&#x27;</span>,<span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;Normalized&#x27;</span>,<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0.13</span> <span class="number">0.16</span> <span class="number">0.76</span> <span class="number">0.76</span>]);</span><br><span class="line">            h.zoomButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.webPlottingPanel, ...</span><br><span class="line">                <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;togglebutton&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;Normalized&#x27;</span>,...</span><br><span class="line">                <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.1</span>+<span class="number">0.02</span>, <span class="number">0.92</span>, <span class="number">0.18</span>, <span class="number">0.08</span>], ...</span><br><span class="line">                <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Zoom&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">                <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">                <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">                ...<span class="string">&#x27;Value&#x27;</span>,<span class="number">0</span>, ...</span><br><span class="line">                <span class="string">&#x27;Callback&#x27;</span>, @zoomToggle);</span><br><span class="line">            </span><br><span class="line">            h.dataCursorButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.webPlottingPanel, ...</span><br><span class="line">                <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;togglebutton&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;Normalized&#x27;</span>,...</span><br><span class="line">                <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.32</span>, <span class="number">0.92</span>, <span class="number">0.22</span>, <span class="number">0.08</span>], ...</span><br><span class="line">                <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Data Cursor&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">                <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">                <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">                ...<span class="string">&#x27;Value&#x27;</span>,<span class="number">0</span>, ...</span><br><span class="line">                <span class="string">&#x27;Callback&#x27;</span>, @dataCursorToggle);</span><br><span class="line">            </span><br><span class="line">            h.panButton = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.webPlottingPanel, ...</span><br><span class="line">                <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;togglebutton&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;Normalized&#x27;</span>,...</span><br><span class="line">                <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.54</span>+<span class="number">0.02</span>, <span class="number">0.92</span>, <span class="number">0.18</span>, <span class="number">0.08</span>], ...</span><br><span class="line">                <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Pan&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">                <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">                <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">                ...<span class="string">&#x27;Value&#x27;</span>,<span class="number">0</span>, ...</span><br><span class="line">                <span class="string">&#x27;Callback&#x27;</span>, @panToggle);</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            <span class="comment">% You would call this function typically from a &#x27;Restore&#x27; button callback like this:</span></span><br><span class="line">             uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.webPlottingPanel, ...</span><br><span class="line">                <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;Normalized&#x27;</span>,...</span><br><span class="line">                <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.76</span>, <span class="number">0.92</span>, <span class="number">0.22</span>, <span class="number">0.08</span>], ...</span><br><span class="line">                <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Restore&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">                <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">                <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">                ...<span class="string">&#x27;Value&#x27;</span>,<span class="number">0</span>, ...</span><br><span class="line">                <span class="string">&#x27;Callback&#x27;</span>, @restorePlot);</span><br><span class="line">            </span><br><span class="line">            h.exportWebPlot = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.webPlottingPanel, ...</span><br><span class="line">                <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;Normalized&#x27;</span>,...</span><br><span class="line">                <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.02</span>, <span class="number">0.02</span>, <span class="number">0.30</span>, <span class="number">0.08</span>], ...</span><br><span class="line">                <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Export PNG&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">                <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">                <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">                ...<span class="string">&#x27;Value&#x27;</span>,<span class="number">0</span>, ...</span><br><span class="line">                <span class="string">&#x27;Callback&#x27;</span>, @exportPlot);</span><br><span class="line">            </span><br><span class="line">            h.exportWebPlot = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, h.webPlottingPanel, ...</span><br><span class="line">                <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;Normalized&#x27;</span>,...</span><br><span class="line">                <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.70</span>, <span class="number">0.02</span>, <span class="number">0.30</span>, <span class="number">0.08</span>], ...</span><br><span class="line">                <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Export Word&#x27;</span>, ...</span><br><span class="line">                <span class="string">&#x27;FontSize&#x27;</span>, <span class="number">14</span>, ...</span><br><span class="line">                <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>], ...</span><br><span class="line">                <span class="string">&#x27;ForegroundColor&#x27;</span>, [<span class="number">50</span> <span class="number">50</span> <span class="number">50</span>]/<span class="number">255</span>, ...</span><br><span class="line">                ...<span class="string">&#x27;Value&#x27;</span>,<span class="number">0</span>, ...</span><br><span class="line">                <span class="string">&#x27;Callback&#x27;</span>, @exportWord);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">% Convert webData.data to a numeric matrix if they are stored as strings</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">% Get the data from the webTable</span></span><br><span class="line">            data = get(h.webTable, <span class="string">&#x27;Data&#x27;</span>);</span><br><span class="line">            <span class="comment">% Convert cell array to table</span></span><br><span class="line">            numericData = str2double(data);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">% Extract the Open, High, Low, Close data</span></span><br><span class="line">            ohlcData = numericData(:, <span class="number">2</span>:<span class="number">5</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">% Now, convert the date strings to a datetime array</span></span><br><span class="line">            dates = datetime(data(:,<span class="number">1</span>), <span class="string">&#x27;InputFormat&#x27;</span>, <span class="string">&#x27;yyyy-MM-dd&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">            tableTMW =  timetable(dates,ohlcData(:,<span class="number">1</span>),ohlcData(:,<span class="number">4</span>),ohlcData(:,<span class="number">3</span>),ohlcData(:,<span class="number">2</span>));</span><br><span class="line">            </span><br><span class="line">            tableTMW.Properties.VariableNames = &#123;<span class="string">&#x27;open&#x27;</span>;<span class="string">&#x27;high&#x27;</span>;<span class="string">&#x27;low&#x27;</span>;<span class="string">&#x27;close&#x27;</span>&#125;;</span><br><span class="line">            </span><br><span class="line">             <span class="comment">% Use the Financial Toolbox candle function to create the plot</span></span><br><span class="line">            hCandle =  candle(h.ax,tableTMW, <span class="string">&#x27;blue&#x27;</span>);</span><br><span class="line">            h.ax.XTickLabelRotation = <span class="number">0</span>;</span><br><span class="line">            grid on</span><br><span class="line">            set(h.ax,<span class="string">&#x27;ylim&#x27;</span>,[<span class="number">2500</span> <span class="number">3200</span>],<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">13</span>,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>,<span class="string">&#x27;TickLength&#x27;</span>,[<span class="number">0.022</span> <span class="number">0.022</span>]);</span><br><span class="line">            <span class="comment">% Label the axes and title</span></span><br><span class="line">            xlabel(<span class="string">&#x27;Date&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">14</span>,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>);</span><br><span class="line">            ylabel(<span class="string">&#x27;Price&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">14</span>,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span>);</span><br><span class="line">          </span><br><span class="line">            </span><br><span class="line">            modifyCandleStick();</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">% Callback function to export table data to Excel</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">exportToExcel</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="comment">% Get the data from the webTable</span></span><br><span class="line">        data = get(h.webTable, <span class="string">&#x27;Data&#x27;</span>);</span><br><span class="line">        <span class="comment">% Convert cell array to table</span></span><br><span class="line">        T = cell2table(data, <span class="string">&#x27;VariableNames&#x27;</span>, h.webTable.ColumnName);</span><br><span class="line">        <span class="comment">% Define Excel file name</span></span><br><span class="line">        excelFileName = <span class="string">&#x27;stock_data.xlsx&#x27;</span>;</span><br><span class="line">        <span class="comment">% Write table data to Excel file</span></span><br><span class="line">        <span class="built_in">writetable</span>(T, excelFileName);</span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;Data exported to &#x27;</span>, excelFileName]);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Callback function to export table data to TXT</span></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">exportToTxt</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="comment">% Get the data from the webTable</span></span><br><span class="line">        data = get(h.webTable, <span class="string">&#x27;Data&#x27;</span>);</span><br><span class="line">        <span class="comment">% Define TXT file name</span></span><br><span class="line">        txtFileName = <span class="string">&#x27;stock_data.txt&#x27;</span>;</span><br><span class="line">        <span class="comment">% Open the TXT file for writing</span></span><br><span class="line">        fileID = fopen(txtFileName, <span class="string">&#x27;wt&#x27;</span>);</span><br><span class="line">        <span class="comment">% Write the headers</span></span><br><span class="line">        fprintf(fileID, <span class="string">&#x27;%s\t%s\t%s\t%s\t%s\n&#x27;</span>, h.webTable.ColumnName&#123;:&#125;);</span><br><span class="line">        <span class="comment">% Write the data</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">size</span>(data, <span class="number">1</span>)</span><br><span class="line">            fprintf(fileID, <span class="string">&#x27;%s\t%s\t%s\t%s\t%s\n&#x27;</span>, data&#123;<span class="built_in">i</span>, :&#125;);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="comment">% Close the file</span></span><br><span class="line">        fclose(fileID);</span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;Data exported to &#x27;</span>, txtFileName]);</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">exportToExcelWithColor</span><span class="params">(~,~)</span></span></span><br><span class="line">        <span class="comment">% Get the data from the webTable</span></span><br><span class="line">        data = get(h.webTable, <span class="string">&#x27;Data&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Convert cell array to table</span></span><br><span class="line">        T = cell2table(data, <span class="string">&#x27;VariableNames&#x27;</span>, h.webTable.ColumnName);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Define Excel file name</span></span><br><span class="line">        excelFileName = <span class="string">&#x27;stock_data.xlsx&#x27;</span>;</span><br><span class="line">        <span class="comment">% Write table data to Excel file</span></span><br><span class="line">        <span class="built_in">writetable</span>(T, excelFileName);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Start an ActiveX server to Excel</span></span><br><span class="line">        Excel = actxserver(<span class="string">&#x27;Excel.Application&#x27;</span>);</span><br><span class="line">        Excel.Visible = <span class="built_in">true</span>; <span class="comment">% if you want to see this happen</span></span><br><span class="line">        Workbook = Excel.Workbooks.Open(fullfile(pwd, excelFileName));</span><br><span class="line">        Sheets = Excel.ActiveWorkbook.Sheets;</span><br><span class="line">        Sheet = Sheets.Item(<span class="number">1</span>); <span class="comment">% assumes data is in the first sheet</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Get range of cells where data is written</span></span><br><span class="line">        Range = Sheet.Range(<span class="string">&#x27;B2:E2&#x27;</span>); <span class="comment">% Adjust range for your data</span></span><br><span class="line">        Range.Resize(<span class="built_in">size</span>(data,<span class="number">1</span>), <span class="built_in">size</span>(data,<span class="number">2</span>)).Interior.ColorIndex = <span class="number">0</span>; <span class="comment">% Clear any existing colors</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Loop over each row and set color based on condition</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">size</span>(data,<span class="number">1</span>)</span><br><span class="line">            cellOpenPrice = Sheet.Range([<span class="string">&#x27;B&#x27;</span> num2str(<span class="built_in">i</span>+<span class="number">1</span>)]);</span><br><span class="line">            cellClosePrice = Sheet.Range([<span class="string">&#x27;C&#x27;</span> num2str(<span class="built_in">i</span>+<span class="number">1</span>)]);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> cellClosePrice.Value &gt; cellOpenPrice.Value</span><br><span class="line">                cellClosePrice.Interior.Color = <span class="number">255</span>; <span class="comment">% Red</span></span><br><span class="line">            <span class="keyword">elseif</span> cellClosePrice.Value &lt; cellOpenPrice.Value</span><br><span class="line">                cellClosePrice.Interior.Color = <span class="number">5287936</span>; <span class="comment">% Green</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Save and close</span></span><br><span class="line">        Workbook.Save;</span><br><span class="line">        Workbook.Close;</span><br><span class="line">        Excel.Quit;</span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">zoomToggle</span><span class="params">(src,~)</span></span></span><br><span class="line">        <span class="comment">% Toggle the zoom state based on the button&#x27;s value</span></span><br><span class="line">        <span class="keyword">if</span> get(src, <span class="string">&#x27;Value&#x27;</span>)</span><br><span class="line">            zoom(h.ax, <span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">            set(src, <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>]); <span class="comment">% Change color to indicate &#x27;on&#x27; state</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            zoom(h.ax, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">            set(src, <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span>, <span class="number">0.94</span>, <span class="number">0.94</span>]); <span class="comment">% Reset color to default</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">dataCursorToggle</span><span class="params">(src,~)</span></span></span><br><span class="line">        <span class="comment">% Toggle the data cursor mode based on the button&#x27;s value</span></span><br><span class="line">        <span class="keyword">if</span> get(src, <span class="string">&#x27;Value&#x27;</span>)</span><br><span class="line">            datacursormode(h.fig, <span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">            set(src, <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>]); <span class="comment">% Change color to indicate &#x27;on&#x27; state</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            datacursormode(h.fig, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">            set(src, <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span>, <span class="number">0.94</span>, <span class="number">0.94</span>]); <span class="comment">% Reset color to default</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">panToggle</span><span class="params">(src,~)</span></span></span><br><span class="line">        <span class="comment">% Toggle the rotate 3D state based on the button&#x27;s value</span></span><br><span class="line">        <span class="keyword">if</span> get(src, <span class="string">&#x27;Value&#x27;</span>)</span><br><span class="line">            pan(h.ax, <span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">            set(src, <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.5</span>, <span class="number">0.5</span>, <span class="number">0.5</span>]); <span class="comment">% Change color to indicate &#x27;on&#x27; state</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            pan(h.ax, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">            set(src, <span class="string">&#x27;BackgroundColor&#x27;</span>, [<span class="number">0.94</span>, <span class="number">0.94</span>, <span class="number">0.94</span>]); <span class="comment">% Reset color to default</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">restorePlot</span><span class="params">(src, ~)</span></span></span><br><span class="line">        <span class="comment">% Disable all interactive modes</span></span><br><span class="line">        updateUIControls();</span><br><span class="line">        zoom(h.ax, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">        datacursormode(h.fig, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">        pan(h.ax, <span class="string">&#x27;off&#x27;</span>);</span><br><span class="line">        <span class="comment">% Reset the view to the default 2D view</span></span><br><span class="line">        view(h.ax, <span class="number">2</span>);</span><br><span class="line">        <span class="comment">% Reset zoom level to the default (showing all data)</span></span><br><span class="line">        axis(h.ax, <span class="string">&#x27;auto&#x27;</span>);</span><br><span class="line">        <span class="comment">% Update any UI controls if they exist (e.g., toggle buttons)</span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">updateUIControls</span><span class="params">()</span></span></span><br><span class="line">        <span class="comment">% Assuming you have stored the UI control handles in &#x27;h.zoomBtn&#x27;, etc.</span></span><br><span class="line">        <span class="comment">% Reset the state of the toggle buttons to &#x27;off&#x27;</span></span><br><span class="line">        <span class="keyword">if</span> isfield(h, <span class="string">&#x27;zoomButton&#x27;</span>)</span><br><span class="line">            <span class="comment">%         disp([&#x27;Zoom Button Handle: &#x27;, num2str(h.zoomButton)]); % Debugging line</span></span><br><span class="line">            set(h.zoomButton, <span class="string">&#x27;Value&#x27;</span>, <span class="number">0</span>,<span class="string">&#x27;BackgroundColor&#x27;</span>,[<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>]);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span> isfield(h, <span class="string">&#x27;dataCursorButton&#x27;</span>)</span><br><span class="line">            set(h.dataCursorButton, <span class="string">&#x27;Value&#x27;</span>, <span class="number">0</span>,<span class="string">&#x27;BackgroundColor&#x27;</span>,[<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>]);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> isfield(h, <span class="string">&#x27;panButton&#x27;</span>)</span><br><span class="line">            set(h.panButton, <span class="string">&#x27;Value&#x27;</span>, <span class="number">0</span>,<span class="string">&#x27;BackgroundColor&#x27;</span>,[<span class="number">0.94</span> <span class="number">0.94</span> <span class="number">0.94</span>]);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        set(h.fig, <span class="string">&#x27;HandleVisibility&#x27;</span>, <span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">exportPlot</span><span class="params">(src, ~)</span></span></span><br><span class="line">        <span class="comment">% Ask user for file name and location to save the PNG</span></span><br><span class="line">        [file, path] = uiputfile(<span class="string">&#x27;export.png&#x27;</span>, <span class="string">&#x27;Save image as&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isequal</span>(file, <span class="number">0</span>) || <span class="built_in">isequal</span>(path, <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">disp</span>(<span class="string">&#x27;User clicked cancel.&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            filename = fullfile(path, file);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        figTemp = <span class="built_in">figure</span>;</span><br><span class="line">        figTemp.Visible = <span class="string">&#x27;off&#x27;</span>;</span><br><span class="line">        axTemp = h.ax;</span><br><span class="line">        axTemp1 = copyobj(axTemp,figTemp);</span><br><span class="line">        set(axTemp1,<span class="string">&#x27;Parent&#x27;</span>,figTemp);</span><br><span class="line">        <span class="comment">% You might need to make sure &#x27;h.ax&#x27; is the handle to your axes</span></span><br><span class="line"></span><br><span class="line">        print(figTemp,filename, <span class="string">&#x27;-dpng&#x27;</span>,<span class="string">&#x27;-r300&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">disp</span>([<span class="string">&#x27;Plot saved as &#x27;</span>, filename]); <span class="comment">% Optional message to indicate success</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">exportWord</span><span class="params">(src, ~)</span></span></span><br><span class="line">        <span class="comment">% Ask user for file name and location to save the PNG</span></span><br><span class="line">        [file, path] = uiputfile(<span class="string">&#x27;export.doc&#x27;</span>, <span class="string">&#x27;Save file as&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isequal</span>(file, <span class="number">0</span>) || <span class="built_in">isequal</span>(path, <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">disp</span>(<span class="string">&#x27;User clicked cancel.&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            filename = fullfile(path, file);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">% Create a Word application object</span></span><br><span class="line">        wordApp = actxserver(<span class="string">&#x27;Word.Application&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Make Word application visible (optional)</span></span><br><span class="line">        wordApp.Visible = <span class="number">1</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Create a new document</span></span><br><span class="line">        wordDoc = wordApp.Documents.Add;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Add content to the Word document</span></span><br><span class="line">        wordDoc.Paragraphs.Add; <span class="comment">% Add a new paragraph</span></span><br><span class="line">        wordDoc.Paragraphs.Item(<span class="number">1</span>).Range.Text = <span class="string">&#x27;This is a sample paragraph.&#x27;</span>;</span><br><span class="line">        <span class="comment">% Insert the PNG figure into the Word document</span></span><br><span class="line">        imagePath = <span class="string">&#x27;export.png&#x27;</span>;</span><br><span class="line">        shape = wordDoc.Shapes.AddPicture(imagePath, <span class="built_in">false</span>, <span class="built_in">true</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Save the Word document</span></span><br><span class="line">        wordDoc.SaveAs2(filename);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Close the Word document</span></span><br><span class="line">        wordDoc.Close;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Quit the Word application</span></span><br><span class="line">        wordApp.Quit;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Release the COM objects</span></span><br><span class="line">        wordDoc.release;</span><br><span class="line">        wordApp.release;</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">modifyCandleStick</span><span class="params">()</span></span></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        data = get(h.webTable, <span class="string">&#x27;Data&#x27;</span>);</span><br><span class="line">       dates = datetime(data(:,<span class="number">1</span>), <span class="string">&#x27;InputFormat&#x27;</span>, <span class="string">&#x27;yyyy-MM-dd&#x27;</span>);</span><br><span class="line"></span><br><span class="line">        customRed = [<span class="number">0.6350</span> <span class="number">0.0780</span> <span class="number">0.1840</span>];</span><br><span class="line">        customGreen = [<span class="number">0.4660</span> <span class="number">0.6740</span> <span class="number">0.1880</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Find all objects of type &#x27;patch&#x27; (the candlestick bodies)</span></span><br><span class="line">        <span class="built_in">hold</span>(h.ax,<span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">        patches = findobj(h.ax, <span class="string">&#x27;Type&#x27;</span>, <span class="string">&#x27;patch&#x27;</span>);</span><br><span class="line">        lines = findobj(gca, <span class="string">&#x27;Type&#x27;</span>, <span class="string">&#x27;line&#x27;</span>);</span><br><span class="line">        lineXData = <span class="built_in">fliplr</span>(get(lines, <span class="string">&#x27;XData&#x27;</span>));</span><br><span class="line">        lineYData = <span class="built_in">fliplr</span>(get(lines, <span class="string">&#x27;YData&#x27;</span>));</span><br><span class="line">        delete(lines);</span><br><span class="line">        <span class="comment">% Loop through the patches to adjust their colors</span></span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(patches)</span><br><span class="line">            </span><br><span class="line">            patchXData = get(patches(<span class="built_in">i</span>), <span class="string">&#x27;XData&#x27;</span>);</span><br><span class="line">            <span class="comment">% Determine the corresponding date index based on XData</span></span><br><span class="line"><span class="comment">%             dateIndex = find(dates == patchXData(1));</span></span><br><span class="line">            </span><br><span class="line">            yData = get(patches(<span class="built_in">i</span>),<span class="string">&#x27;YData&#x27;</span>);</span><br><span class="line">            openPrices = yData(<span class="number">1</span>);</span><br><span class="line">            closePrices = yData(<span class="number">2</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">% Compare open and close prices for the current date</span></span><br><span class="line">            <span class="keyword">if</span> closePrices &gt; openPrices</span><br><span class="line">                <span class="comment">% If close is greater than open, set the body to customRed</span></span><br><span class="line">                set(patches(<span class="built_in">i</span>), <span class="string">&#x27;FaceColor&#x27;</span>, <span class="string">&#x27;None&#x27;</span> ,<span class="string">&#x27;EdgeColor&#x27;</span>,customRed);</span><br><span class="line">                <span class="built_in">plot</span>(h.ax,[lineXData(<span class="number">3</span>*<span class="built_in">i</span><span class="number">-1</span>) lineXData(<span class="number">3</span>*<span class="built_in">i</span>)], [lineYData(<span class="number">3</span>*<span class="built_in">i</span><span class="number">-1</span>) lineYData(<span class="number">3</span>*<span class="built_in">i</span>)],...</span><br><span class="line">                       <span class="string">&#x27;Color&#x27;</span>,customRed,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">1.1</span>)</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="comment">% If close is less than or equal to open, set the body to customGreen</span></span><br><span class="line">                set(patches(<span class="built_in">i</span>), <span class="string">&#x27;FaceColor&#x27;</span>,<span class="string">&#x27;none&#x27;</span>,<span class="string">&#x27;EdgeColor&#x27;</span>, customGreen);</span><br><span class="line">                <span class="built_in">plot</span>(h.ax,[lineXData(<span class="number">3</span>*<span class="built_in">i</span><span class="number">-1</span>) lineXData(<span class="number">3</span>*<span class="built_in">i</span>)], [lineYData(<span class="number">3</span>*<span class="built_in">i</span><span class="number">-1</span>) lineYData(<span class="number">3</span>*<span class="built_in">i</span>)],...</span><br><span class="line">                    <span class="string">&#x27;Color&#x27;</span>,customGreen,<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">1.1</span>)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">% Callback function for returning to the main panel</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">returnToMainPanel</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="comment">% Delete the calculator interface or word lookup interface and show the main panel</span></span><br><span class="line">        panelFields = &#123;<span class="string">&#x27;calculatorPanel&#x27;</span>, <span class="string">&#x27;wordLookupPanel&#x27;</span>, <span class="string">&#x27;StockMarketPanel&#x27;</span>,<span class="string">&#x27;webPlottingPanel&#x27;</span>,<span class="string">&#x27;ax&#x27;</span>&#125;;</span><br><span class="line">        <span class="comment">% Loop over each field name and delete the field if it exists</span></span><br><span class="line">        <span class="keyword">for</span> k = <span class="number">1</span>:<span class="built_in">numel</span>(panelFields)</span><br><span class="line">            fieldName = panelFields&#123;k&#125;;</span><br><span class="line">            <span class="keyword">if</span> isfield(h, fieldName)</span><br><span class="line"><span class="comment">%                 delete(h.(fieldName).Children)</span></span><br><span class="line">                delete(h.(fieldName));</span><br><span class="line">               h = rmfield(h, fieldName); <span class="comment">% Optionally remove the field from the structure</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        set(h.panel, <span class="string">&#x27;Visible&#x27;</span>, <span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">        set(h.fig, <span class="string">&#x27;Color&#x27;</span>, [<span class="number">0.95</span> <span class="number">0.95</span> <span class="number">0.95</span>]);</span><br><span class="line">        set(h.fig, <span class="string">&#x27;WindowKeyPressFcn&#x27;</span>, @keyPressCallback);</span><br><span class="line">        set(h.fig,<span class="string">&#x27;Position&#x27;</span>,h.figOriginPosition);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>


<h2 id="This-is-another-GUI-tool-used-for-a-file-filter-with-some-fancy-stuff"><a href="#This-is-another-GUI-tool-used-for-a-file-filter-with-some-fancy-stuff" class="headerlink" title="This is another GUI tool used for a file filter with some fancy stuff."></a>This is another GUI tool used for a file filter with some fancy stuff.</h2><figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">file_explorer</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">if</span> exist(<span class="string">&#x27;myTempDataBase.txt&#x27;</span>, <span class="string">&#x27;file&#x27;</span>)</span><br><span class="line">        database = readcell(<span class="string">&#x27;myTempDataBase.txt&#x27;</span>,<span class="string">&#x27;Delimiter&#x27;</span>,<span class="string">&#x27;Tab&#x27;</span>,<span class="string">&#x27;LineEnding&#x27;</span>,<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        database = []; <span class="comment">% Initialize an empty database or however you wish</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">% Create the main figure window</span></span><br><span class="line">    main_fig = <span class="built_in">figure</span>(<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;File Explorer&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">100</span>, <span class="number">100</span>, <span class="number">800</span>, <span class="number">600</span>]...</span><br><span class="line">                                        , <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;pixels&#x27;</span>, <span class="string">&#x27;Resize&#x27;</span>, <span class="string">&#x27;on&#x27;</span>, <span class="string">&#x27;NumberTitle&#x27;</span>, <span class="string">&#x27;off&#x27;</span> ...</span><br><span class="line">                                        , <span class="string">&#x27;MenuBar&#x27;</span>, <span class="string">&#x27;none&#x27;</span>,<span class="string">&#x27;CloseRequestFcn&#x27;</span>,&#123;@saveDatabaseOnClose,database&#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">% Create a panel for the controls</span></span><br><span class="line">    controls_panel = uipanel(<span class="string">&#x27;Parent&#x27;</span>, main_fig, <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;Controls&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.01</span>, <span class="number">0.88</span>, <span class="number">0.98</span>, <span class="number">0.11</span>]);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">% Create the file retrieval button</span></span><br><span class="line">    btn_retrieve = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Retrieve Files&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.01</span>, <span class="number">0.1</span>, <span class="number">0.10</span>, <span class="number">0.5</span>], <span class="string">&#x27;Callback&#x27;</span>, @retrieve_files);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">% Create the sorting button</span></span><br><span class="line">    btn_sort = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Sort by Date&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.11</span>, <span class="number">0.1</span>, <span class="number">0.10</span>, <span class="number">0.5</span>], <span class="string">&#x27;Callback&#x27;</span>, @sort_files);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">% Create the open button</span></span><br><span class="line">    btn_open = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Open&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.21</span>, <span class="number">0.1</span>, <span class="number">0.06</span>, <span class="number">0.5</span>], <span class="string">&#x27;Callback&#x27;</span>, @open_file);</span><br><span class="line"></span><br><span class="line">     panel_filter = uipanel(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;Filter&#x27;</span>...</span><br><span class="line">                                        ,<span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;normalized&#x27;</span> ,<span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.27</span>, <span class="number">0.05</span>, <span class="number">0.36</span>, <span class="number">.92</span>]...</span><br><span class="line">                                        ,<span class="string">&#x27;TitlePosition&#x27;</span>,<span class="string">&#x27;centertop&#x27;</span>);</span><br><span class="line">     btn_filter = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Filter File&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.28</span>, <span class="number">0.1</span>, <span class="number">0.08</span>, <span class="number">0.5</span>], <span class="string">&#x27;Callback&#x27;</span>, @loadFileFilter);</span><br><span class="line">     btn_filterSearch = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;edit&#x27;</span>, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.36</span>, <span class="number">0.1</span>, <span class="number">0.1</span>, <span class="number">0.5</span>], <span class="string">&#x27;Callback&#x27;</span>, @searchKeyWordsCallBack);</span><br><span class="line"></span><br><span class="line">     btn_saveData = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Save&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.46</span>, <span class="number">0.1</span>, <span class="number">0.08</span>, <span class="number">0.5</span>], <span class="string">&#x27;Callback&#x27;</span>, @SaveFilterData);</span><br><span class="line">      btn_loadData = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;pushbutton&#x27;</span>, <span class="string">&#x27;String&#x27;</span>, <span class="string">&#x27;Load&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.54</span>, <span class="number">0.1</span>, <span class="number">0.08</span>, <span class="number">0.5</span>], <span class="string">&#x27;Callback&#x27;</span>, @loadFileFilterData);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    btn_searchBar = uipanel(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Title&#x27;</span>,<span class="string">&#x27;Search&#x27;</span>, <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.64</span>, <span class="number">0.05</span>, <span class="number">0.15</span>, <span class="number">0.92</span>],<span class="string">&#x27;TitlePosition&#x27;</span>,<span class="string">&#x27;centertop&#x27;</span>);</span><br><span class="line">    edit_search = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;edit&#x27;</span>, <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.65</span>, <span class="number">0.10</span>, <span class="number">0.13</span>, <span class="number">0.5</span>], <span class="string">&#x27;Callback&#x27;</span>, @search_files,<span class="string">&#x27;ButtonDownFcn&#x27;</span>,@clear_search);</span><br><span class="line">    edit_clicked = <span class="built_in">false</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     table_dataFilter = uitable(<span class="string">&#x27;Parent&#x27;</span>, main_fig, <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.01</span>, <span class="number">0.01</span>, <span class="number">0.98</span>, <span class="number">0.86</span>], ...</span><br><span class="line">        <span class="string">&#x27;ColumnName&#x27;</span>, &#123;<span class="string">&#x27;Search Result&#x27;</span>&#125;, ...</span><br><span class="line">        <span class="string">&#x27;ColumnWidth&#x27;</span>, &#123;<span class="number">830</span>&#125;, <span class="string">&#x27;RowName&#x27;</span>, []...</span><br><span class="line">        ,<span class="string">&#x27;CellSelectionCallback&#x27;</span>,@table_selection_callback...</span><br><span class="line">        ,<span class="string">&#x27;ButtonDownFcn&#x27;</span>,@tableClickHandle...</span><br><span class="line">        ,<span class="string">&#x27;Visible&#x27;</span>,<span class="string">&#x27;on&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">15</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">         table_dataFilter.Visible = <span class="string">&#x27;off&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">% Create the table to display the file information</span></span><br><span class="line">    table_data = uitable(<span class="string">&#x27;Parent&#x27;</span>, main_fig, <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.01</span>, <span class="number">0.01</span>, <span class="number">0.98</span>, <span class="number">0.86</span>], ...</span><br><span class="line">        <span class="string">&#x27;ColumnName&#x27;</span>, &#123;<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;Type&#x27;</span>, <span class="string">&#x27;Size (MB)&#x27;</span>, <span class="string">&#x27;Date&#x27;</span>, <span class="string">&#x27;Path&#x27;</span>&#125;, ...</span><br><span class="line">        <span class="string">&#x27;ColumnWidth&#x27;</span>, &#123;<span class="number">200</span>, <span class="number">80</span>, <span class="number">100</span>, <span class="number">150</span>, <span class="number">300</span>&#125;, <span class="string">&#x27;RowName&#x27;</span>, []...</span><br><span class="line">        ,<span class="string">&#x27;CellSelectionCallback&#x27;</span>,@table_selection_callback...</span><br><span class="line">        ,<span class="string">&#x27;ButtonDownFcn&#x27;</span>,@tableClickHandle);</span><br><span class="line">    </span><br><span class="line">  <span class="comment">% Wait for uitable to be ready</span></span><br><span class="line">    drawnow;</span><br><span class="line">        <span class="comment">% Access Java component of uitable</span></span><br><span class="line">    jScroll = findjobj(table_data);</span><br><span class="line">    jTable = jScroll.getViewport.getView;</span><br><span class="line">    <span class="comment">% Set up a MouseListener for double-click detection</span></span><br><span class="line">    set(jTable, <span class="string">&#x27;MouseClickedCallback&#x27;</span>, @(src, event)onTableClick(src, event));</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    jScroll2 = findjobj(table_dataFilter);</span><br><span class="line">    jTable2 = jScroll2.getViewport.getView;</span><br><span class="line">    <span class="comment">% Set up a MouseListener for double-click detection</span></span><br><span class="line">    set(jTable2, <span class="string">&#x27;MouseClickedCallback&#x27;</span>, @(src, event)onTableClick(src, event));</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">     <span class="comment">% Define a MATLAB context menu</span></span><br><span class="line">    cMenu = uicontextmenu;</span><br><span class="line">    uimenu(cMenu, <span class="string">&#x27;Label&#x27;</span>, <span class="string">&#x27;Copy&#x27;</span>, <span class="string">&#x27;Callback&#x27;</span>, @(src, event)copyFileOrFolderAction(jTable));</span><br><span class="line">    uimenu(cMenu, <span class="string">&#x27;Label&#x27;</span>, <span class="string">&#x27;Open Folder Path&#x27;</span>, <span class="string">&#x27;Callback&#x27;</span>, @(src, event)openFolderPathAction());</span><br><span class="line"><span class="comment">%     uimenu(cMenu, &#x27;Label&#x27;, &#x27;Properties&#x27;, &#x27;Callback&#x27;, @(src, event)showPropertiesAction(jTable));</span></span><br><span class="line">    </span><br><span class="line">    set(jTable, <span class="string">&#x27;MousePressedCallback&#x27;</span>, @(src, event)onTableRightClick(src, event, cMenu,table_data));</span><br><span class="line">    </span><br><span class="line">   <span class="comment">% Set the maximum number of rows</span></span><br><span class="line">   <span class="comment">%  table_data.Data = cell(1000, 5); % Initialize with 1000 rows</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">% Initialize variables</span></span><br><span class="line">    files = []; file_info = [];</span><br><span class="line">    sort_order = <span class="number">1</span>; <span class="comment">% 1 for descending, -1 for ascending</span></span><br><span class="line">    </span><br><span class="line">    path = [];</span><br><span class="line">    pathIndex = [];</span><br><span class="line">    line_number = [];</span><br><span class="line">    <span class="comment">% Create the text label for the edit component</span></span><br><span class="line">    label_folder = uipanel(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Title&#x27;</span>, <span class="string">&#x27;Folder Path&#x27;</span>, <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.80</span>, <span class="number">0.05</span>, <span class="number">0.185</span>, <span class="number">0.92</span>],<span class="string">&#x27;TitlePosition&#x27;</span>,<span class="string">&#x27;centertop&#x27;</span>);</span><br><span class="line">    <span class="comment">% Create the text input field</span></span><br><span class="line">    edit_folder = uicontrol(<span class="string">&#x27;Parent&#x27;</span>, controls_panel, <span class="string">&#x27;Style&#x27;</span>, <span class="string">&#x27;edit&#x27;</span>, <span class="string">&#x27;Units&#x27;</span>, <span class="string">&#x27;normalized&#x27;</span>, ...</span><br><span class="line">        <span class="string">&#x27;Position&#x27;</span>, [<span class="number">0.81</span>, <span class="number">0.1</span>, <span class="number">0.165</span>, <span class="number">0.5</span>], <span class="string">&#x27;Callback&#x27;</span>, @set_folder,<span class="string">&#x27;String&#x27;</span>,path);</span><br><span class="line">    </span><br><span class="line">        initialiseDatabase(database)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">retrieve_files</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="comment">% Specify the file path</span></span><br><span class="line">        <span class="comment">% Prompt the user to select a folder</span></span><br><span class="line"><span class="comment">%         if isempty(path)</span></span><br><span class="line">            path = uigetdir(<span class="string">&#x27;/Applications/MATLAB_R2021a.app/toolbox/matlab/iofun/&#x27;</span>);</span><br><span class="line">            <span class="keyword">if</span> path == <span class="number">0</span></span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line"><span class="comment">%         end</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">% Initialize the file_info cell array</span></span><br><span class="line">        file_info = &#123;&#125;;</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Recursively retrieve files and update file_info</span></span><br><span class="line">        file_info = retrieveFilesRecursively(path, file_info);</span><br><span class="line"></span><br><span class="line">        table_data.Visible = <span class="string">&#x27;on&#x27;</span>;</span><br><span class="line">        table_dataFilter.Visible = <span class="string">&#x27;off&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">% Update the table data</span></span><br><span class="line">        set(table_data, <span class="string">&#x27;Data&#x27;</span>, file_info);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        edit_folder.String = path;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">loadFileFilter</span><span class="params">(~,~)</span></span></span><br><span class="line">       <span class="keyword">if</span> <span class="built_in">isempty</span>(file_info)</span><br><span class="line">           <span class="keyword">return</span>;</span><br><span class="line">       <span class="keyword">end</span></span><br><span class="line">        <span class="comment">% Filter files by format</span></span><br><span class="line">      </span><br><span class="line">        filtered_data = file_info(contains(file_info(:,<span class="number">1</span>), <span class="string">&#x27;.m&#x27;</span>) | contains(file_info(:,<span class="number">1</span>), <span class="string">&#x27;.txt&#x27;</span>), :);</span><br><span class="line">        <span class="comment">% Update the table data</span></span><br><span class="line">        set(table_data, <span class="string">&#x27;Data&#x27;</span>, filtered_data);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">file_info</span> = <span class="title">retrieveFilesRecursively</span><span class="params">(folderPath, file_info)</span></span></span><br><span class="line">        <span class="comment">% Get the list of files and folders</span></span><br><span class="line">        items = dir(folderPath);</span><br><span class="line">        items = items(~<span class="built_in">ismember</span>(&#123;items.name&#125;, &#123;<span class="string">&#x27;.&#x27;</span>, <span class="string">&#x27;..&#x27;</span>&#125;)); <span class="comment">% Filter out &#x27;.&#x27; and &#x27;..&#x27; entries</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(items)</span><br><span class="line">            currentItemPath = fullfile(folderPath, items(<span class="built_in">i</span>).name);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">% Common details to store</span></span><br><span class="line">            itemSizeMB = bytes2mb(items(<span class="built_in">i</span>).bytes); <span class="comment">% Convert bytes to MB for files, will be 0 for folders</span></span><br><span class="line">            itemDate = datestr(items(<span class="built_in">i</span>).datenum, <span class="string">&#x27;yyyy-mm-dd HH:MM:SS&#x27;</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="keyword">if</span> items(<span class="built_in">i</span>).isdir</span><br><span class="line">                <span class="comment">% Add directory info to file_info before recursing into it</span></span><br><span class="line">                <span class="comment">% Note: Size for directories can be complex to calculate and might not be meaningful;</span></span><br><span class="line">                dirInfo = &#123;items(<span class="built_in">i</span>).name, <span class="string">&#x27;Directory&#x27;</span>, <span class="string">&#x27; &#x27;</span>, itemDate, currentItemPath&#125;;</span><br><span class="line">                file_info&#123;<span class="keyword">end</span>+<span class="number">1</span>, <span class="number">1</span>&#125; = dirInfo&#123;<span class="number">1</span>&#125;; <span class="comment">% Directory name</span></span><br><span class="line">                file_info&#123;<span class="keyword">end</span>, <span class="number">2</span>&#125; = dirInfo&#123;<span class="number">2</span>&#125;; <span class="comment">% Placeholder for size (0 for directories)</span></span><br><span class="line">                file_info&#123;<span class="keyword">end</span>, <span class="number">3</span>&#125; = dirInfo&#123;<span class="number">3</span>&#125;; <span class="comment">% Last modified date</span></span><br><span class="line">                file_info&#123;<span class="keyword">end</span>, <span class="number">4</span>&#125; = dirInfo&#123;<span class="number">4</span>&#125;; <span class="comment">% Full directory path</span></span><br><span class="line">                file_info&#123;<span class="keyword">end</span>, <span class="number">5</span>&#125; = dirInfo&#123;<span class="number">5</span>&#125;; <span class="comment">% Type (File/Directory)</span></span><br><span class="line">                </span><br><span class="line">                <span class="comment">% Recurse into subdirectories</span></span><br><span class="line">                file_info = retrieveFilesRecursively(currentItemPath, file_info);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="comment">% File processing</span></span><br><span class="line">                fileInfo = &#123;items(<span class="built_in">i</span>).name, <span class="string">&#x27;File&#x27;</span>, itemSizeMB, itemDate, currentItemPath&#125;;</span><br><span class="line">                file_info&#123;<span class="keyword">end</span>+<span class="number">1</span>, <span class="number">1</span>&#125; = fileInfo&#123;<span class="number">1</span>&#125;; <span class="comment">% Full file name with extension</span></span><br><span class="line">                file_info&#123;<span class="keyword">end</span>, <span class="number">2</span>&#125; = fileInfo&#123;<span class="number">2</span>&#125;; <span class="comment">% Store file size in MB</span></span><br><span class="line">                file_info&#123;<span class="keyword">end</span>, <span class="number">3</span>&#125; = fileInfo&#123;<span class="number">3</span>&#125;; <span class="comment">% Store last modified date</span></span><br><span class="line">                file_info&#123;<span class="keyword">end</span>, <span class="number">4</span>&#125; = fileInfo&#123;<span class="number">4</span>&#125;; <span class="comment">% Store the full file path</span></span><br><span class="line">                file_info&#123;<span class="keyword">end</span>, <span class="number">5</span>&#125; = fileInfo&#123;<span class="number">5</span>&#125;; <span class="comment">% Type (File/Directory)</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">set_folder</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="comment">% Get the selected folder path from the edit component</span></span><br><span class="line">        folder_path = get(edit_folder, <span class="string">&#x27;String&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Check if the folder path exists</span></span><br><span class="line">        <span class="keyword">if</span> exist(folder_path, <span class="string">&#x27;dir&#x27;</span>)</span><br><span class="line">            <span class="comment">% Retrieve files and update file_info</span></span><br><span class="line">            file_info = retrieveFilesRecursively(folder_path, &#123;&#125;);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">% Update the table data</span></span><br><span class="line">            set(table_data, <span class="string">&#x27;Data&#x27;</span>, file_info);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            errordlg(<span class="string">&#x27;Invalid folder path!&#x27;</span>, <span class="string">&#x27;Error&#x27;</span>);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">sort_files</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="comment">% Get the current table data</span></span><br><span class="line">        file_info = get(table_data, <span class="string">&#x27;Data&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Check if the table data is not empty</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isempty</span>(file_info) || all(<span class="built_in">cellfun</span>(@<span class="built_in">isempty</span>, file_info(:,<span class="number">1</span>)))</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Convert date strings to numbers for sorting</span></span><br><span class="line">        date_values = datenum(file_info(:,<span class="number">4</span>), <span class="string">&#x27;yyyy-mm-dd HH:MM:SS&#x27;</span>);</span><br><span class="line">      </span><br><span class="line">         <span class="keyword">if</span> sort_order</span><br><span class="line">            <span class="comment">% Sort in descending order</span></span><br><span class="line">            [~, idx] = <span class="built_in">sort</span>(date_values, <span class="string">&#x27;descend&#x27;</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="comment">% Sort in ascending order</span></span><br><span class="line">            [~, idx] = <span class="built_in">sort</span>(date_values, <span class="string">&#x27;ascend&#x27;</span>);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Apply sorted index to table data</span></span><br><span class="line">        table_data.Data = file_info(idx,:);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Toggle the sort order for the next sort operation</span></span><br><span class="line">        sort_order = ~sort_order;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">clear_search</span><span class="params">(src,~)</span></span></span><br><span class="line">            edit_clicked = <span class="built_in">true</span>;</span><br><span class="line">            set(src,<span class="string">&#x27;String&#x27;</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">search_files</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="keyword">if</span> edit_clicked</span><br><span class="line">            edit_clicked = <span class="built_in">false</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Get the search term</span></span><br><span class="line">        search_term = get(edit_search, <span class="string">&#x27;String&#x27;</span>);</span><br><span class="line">        search_term = lower(search_term); <span class="comment">% Convert search term to lowercase for case-insensitive comparison</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Always display all files if search term is empty</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isempty</span>(search_term)</span><br><span class="line">               set_folder()</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="comment">% Refresh the table with files that match the search term (case-insensitive)</span></span><br><span class="line">            matching_files = <span class="built_in">cellfun</span>(@(name) contains(lower(name), search_term), file_info(:,<span class="number">1</span>));</span><br><span class="line">            filtered_data = file_info(matching_files, :);</span><br><span class="line">            table_data.Data = filtered_data;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        table_data.Visible = <span class="string">&#x27;on&#x27;</span>;</span><br><span class="line">        table_dataFilter.Visible = <span class="string">&#x27;off&#x27;</span>;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">searchKeyWordsCallBack</span><span class="params">(~, ~)</span></span></span><br><span class="line">        <span class="keyword">if</span> edit_clicked</span><br><span class="line">            edit_clicked = <span class="built_in">false</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">% Get the search term</span></span><br><span class="line">        search_term = get(btn_filterSearch, <span class="string">&#x27;String&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">        fileList = dir(fullfile(path, <span class="string">&#x27;**/*.m&#x27;</span>));</span><br><span class="line">        fileList = [fileList; dir(fullfile(path, <span class="string">&#x27;**/*.txt&#x27;</span>))];</span><br><span class="line">        allMatches = &#123;&#125;; <span class="comment">% Initialize an empty cell array to store all matches</span></span><br><span class="line">        allMatchesPure = &#123;&#125;; <span class="comment">% Initialize an empty cell array to store all matches</span></span><br><span class="line">       mm = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">i</span> = <span class="number">1</span>:<span class="built_in">length</span>(fileList)</span><br><span class="line">            filePath = fullfile(fileList(<span class="built_in">i</span>).folder, fileList(<span class="built_in">i</span>).name);</span><br><span class="line">            fileContent = fileread(filePath);</span><br><span class="line">            expr = [<span class="string">&#x27;[^\n]*&#x27;</span> search_term <span class="string">&#x27;[^\n]*&#x27;</span>];</span><br><span class="line">            [matches, starts] = regexp(fileContent,expr, <span class="string">&#x27;match&#x27;</span>,<span class="string">&#x27;start&#x27;</span> ,<span class="string">&#x27;ignorecase&#x27;</span>);</span><br><span class="line">            matchesHighlighted = <span class="built_in">cellfun</span>(@(x) [ <span class="string">&#x27;&lt;html&gt;&#x27;</span> strrep(x, search_term, [<span class="string">&#x27;&lt;span style=&quot;color: blue;&quot;&gt;&lt;b&gt;&#x27;</span>, search_term, <span class="string">&#x27;&lt;/b&gt;&lt;/span&gt;&#x27;</span>]) <span class="string">&#x27;&lt;/html&gt;&#x27;</span>], matches, <span class="string">&#x27;UniformOutput&#x27;</span>, <span class="built_in">false</span>);</span><br><span class="line">            <span class="comment">% matchesHighlighted = cellfun(@(x) [&#x27;&lt;html&gt;&lt;span style=&quot;color: blue;&quot;&gt;&#x27;, strrep(x, search_term, [&#x27;&lt;b&gt;&#x27;, search_term, &#x27;&lt;/b&gt;&#x27;]), &#x27;&lt;/span&gt;&lt;/html&gt;&#x27;], matches, &#x27;UniformOutput&#x27;, false);</span></span><br><span class="line">            allMatches = [allMatches; matchesHighlighted&#x27;]; <span class="comment">% Append to allMatches</span></span><br><span class="line">            allMatchesPure = [allMatchesPure; matches&#x27;];</span><br><span class="line">            <span class="comment">% Create a logical array where newlines are 1, others are 0</span></span><br><span class="line">            newlines = (fileContent == char(<span class="number">10</span>));</span><br><span class="line">            lineNumbersAtIndices = cumsum([<span class="number">1</span>, newlines]); <span class="comment">% Start from 1 to count lines correctly</span></span><br><span class="line">            lineNumbersForMatches = lineNumbersAtIndices(starts);</span><br><span class="line">            <span class="keyword">if</span> ~<span class="built_in">isempty</span>(matchesHighlighted) </span><br><span class="line">                <span class="keyword">for</span> <span class="built_in">j</span> = <span class="number">1</span>:<span class="built_in">length</span>(matchesHighlighted)</span><br><span class="line">                    pathIndex&#123;mm + <span class="built_in">j</span> <span class="number">-1</span>&#125; =  filePath;</span><br><span class="line">                    line_number(mm+<span class="built_in">j</span><span class="number">-1</span>) = lineNumbersForMatches(<span class="built_in">j</span>);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">                mm = mm + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        table_data.Visible = <span class="string">&#x27;off&#x27;</span>;</span><br><span class="line">        table_dataFilter.Visible = <span class="string">&#x27;on&#x27;</span>;</span><br><span class="line">        table_dataFilter.Data  = allMatches;</span><br><span class="line"></span><br><span class="line">        jtableFilter = findjobj(table_dataFilter);</span><br><span class="line">        height = jtableFilter.getViewport.getView.getRowHeight;</span><br><span class="line">        <span class="keyword">if</span> height &lt; <span class="number">30</span></span><br><span class="line">            jtableFilter.getViewport.getView.setRowHeight(<span class="number">2</span>*height)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">        setappdata(btn_saveData,<span class="string">&#x27;allMatchesPure&#x27;</span>,allMatchesPure);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">SaveFilterData</span><span class="params">(~,~)</span></span></span><br><span class="line"></span><br><span class="line">        [fileName1, folder_path] = uiputfile(&#123;<span class="string">&#x27;example*.txt&#x27;</span>,<span class="string">&#x27;Text Files (*.txt)&#x27;</span>;...</span><br><span class="line">            <span class="string">&#x27;example*.mat&#x27;</span>,<span class="string">&#x27;Mat Files (*.mat)&#x27;</span>;...</span><br><span class="line">            <span class="string">&#x27;example*.*&#x27;</span>,<span class="string">&#x27;All Files (*.*)&#x27;</span>&#125;,...</span><br><span class="line">            <span class="string">&#x27;Save as&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isequal</span>(fileName1,<span class="number">0</span>) || <span class="built_in">isequal</span>(folder_path,<span class="number">0</span>)</span><br><span class="line">            <span class="comment">% User pressed cancel or closed the dialog</span></span><br><span class="line">            <span class="built_in">disp</span>(<span class="string">&#x27;User cancelled the save operation.&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            fullFilePath = fullfile(folder_path, fileName1);</span><br><span class="line">            <span class="comment">% allMatchesPure = regexprep(getappdata(btn_saveData, &#x27;allMatchesPure&#x27;),&#x27;\&quot;&#x27;,&#x27; &#x27;);</span></span><br><span class="line">            allMatchesPure = getappdata(btn_saveData, <span class="string">&#x27;allMatchesPure&#x27;</span>);</span><br><span class="line">            writecell(allMatchesPure,fullFilePath,<span class="string">&#x27;Delimiter&#x27;</span>,<span class="string">&#x27;tab&#x27;</span>,<span class="string">&#x27;QuoteStrings&#x27;</span>,<span class="built_in">false</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">loadFileFilterData</span><span class="params">(~,~)</span></span></span><br><span class="line">        [fileName1,folder_path,indx] = uigetfile( ...</span><br><span class="line">            &#123;<span class="string">&#x27;*.txt;*.csv&#x27;</span>,<span class="string">&#x27;Text File (*.txt,*csv)&#x27;</span>; ...</span><br><span class="line">           ... <span class="string">&#x27;*.m;*.mlx;*.fig;*.mat;*.slx;*.mdl&#x27;</span>,...</span><br><span class="line">           ... <span class="string">&#x27;MATLAB Files (*.m,*.mlx,*.fig,*.mat,*.slx,*.mdl)&#x27;</span>;</span><br><span class="line">           ... <span class="string">&#x27;*.m;*.mlx&#x27;</span>,<span class="string">&#x27;Code files (*.m,*.mlx)&#x27;</span>; ...</span><br><span class="line">           ... <span class="string">&#x27;*.fig&#x27;</span>,<span class="string">&#x27;Figures (*.fig)&#x27;</span>; ...</span><br><span class="line">            <span class="string">&#x27;*.mat&#x27;</span>,<span class="string">&#x27;MAT-files (*.mat)&#x27;</span>; ...</span><br><span class="line">            ...<span class="string">&#x27;*.mdl;*.slx&#x27;</span>,<span class="string">&#x27;Models (*.slx, *.mdl)&#x27;</span>; ...</span><br><span class="line">            <span class="string">&#x27;*.*&#x27;</span>,  <span class="string">&#x27;All Files (*.*)&#x27;</span>&#125;, ...</span><br><span class="line">            <span class="string">&#x27;Select a File&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isequal</span>(fileName1,<span class="number">0</span>) || <span class="built_in">isequal</span>(folder_path,<span class="number">0</span>)</span><br><span class="line">            <span class="comment">% User pressed cancel or closed the dialog</span></span><br><span class="line">            <span class="built_in">disp</span>(<span class="string">&#x27;User cancelled the loading operation.&#x27;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            fullFilePath = fullfile(folder_path, fileName1);</span><br><span class="line">            allMatchesPure = readcell(fullFilePath,<span class="string">&#x27;Delimiter&#x27;</span>,<span class="string">&#x27;tab&#x27;</span>,<span class="string">&#x27;LineEnding&#x27;</span>,<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">            table_data.Visible = <span class="string">&#x27;off&#x27;</span>;</span><br><span class="line">            table_dataFilter.Visible = <span class="string">&#x27;on&#x27;</span>;</span><br><span class="line">            table_dataFilter.Data  = allMatchesPure;</span><br><span class="line"></span><br><span class="line">            jtableFilter = findjobj(table_dataFilter);</span><br><span class="line">            height = jtableFilter.getViewport.getView.getRowHeight;</span><br><span class="line">            <span class="keyword">if</span> height &lt; <span class="number">30</span></span><br><span class="line">                jtableFilter.getViewport.getView.setRowHeight(<span class="number">2</span>*height)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            setappdata(btn_saveData,<span class="string">&#x27;allMatchesPure&#x27;</span>,allMatchesPure);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">initialiseDatabase</span><span class="params">(database)</span></span></span><br><span class="line">        <span class="keyword">if</span> ~<span class="built_in">isempty</span>(database)</span><br><span class="line">            allMatchesPure = database;</span><br><span class="line">            table_data.Visible = <span class="string">&#x27;off&#x27;</span>;</span><br><span class="line">            table_dataFilter.Visible = <span class="string">&#x27;on&#x27;</span>;</span><br><span class="line">            table_dataFilter.Data  = allMatchesPure;</span><br><span class="line">            jtableFilter = findjobj(table_dataFilter);</span><br><span class="line">            height = jtableFilter.getViewport.getView.getRowHeight;</span><br><span class="line">            <span class="keyword">if</span> height &lt; <span class="number">30</span></span><br><span class="line">                jtableFilter.getViewport.getView.setRowHeight(<span class="number">2</span>*height)</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">            setappdata(btn_saveData,<span class="string">&#x27;allMatchesPure&#x27;</span>,allMatchesPure);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">saveDatabaseOnClose</span><span class="params">(src, ~, database)</span></span></span><br><span class="line">        <span class="keyword">if</span> ~<span class="built_in">isempty</span>(table_dataFilter.Data)</span><br><span class="line">            allMatchesPure = getappdata(btn_saveData, <span class="string">&#x27;allMatchesPure&#x27;</span>);</span><br><span class="line">            fullFilePath = pwd;</span><br><span class="line">            writecell(allMatchesPure,[fullFilePath <span class="string">&#x27;/myTempDatabase.txt&#x27;</span>],<span class="string">&#x27;Delimiter&#x27;</span>,<span class="string">&#x27;tab&#x27;</span>,<span class="string">&#x27;QuoteStrings&#x27;</span>,<span class="built_in">false</span>);</span><br><span class="line">            delete(src);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">table_selection_callback</span><span class="params">(src, event)</span></span></span><br><span class="line">        <span class="keyword">if</span> ~<span class="built_in">isempty</span>(event.Indices)</span><br><span class="line">            src.UserData = event.Indices(<span class="number">1</span>); <span class="comment">% Store the row index in UserData</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            src.UserData = []; <span class="comment">% Clear selection if no cell is selected</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">            pause(<span class="number">0.4</span>); <span class="comment">% to allow the user time to add a second click</span></span><br><span class="line">            <span class="keyword">if</span> strcmpi(main_fig.SelectionType, <span class="string">&#x27;open&#x27;</span>)</span><br><span class="line"><span class="comment">%                 fprintf(1, &#x27;Double click on cell&#x27;);</span></span><br><span class="line">                open_file();</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">onTableClick</span><span class="params">(~, event)</span></span></span><br><span class="line">        <span class="comment">% Check if the event is a double-click</span></span><br><span class="line">        <span class="keyword">if</span> event.getClickCount() == <span class="number">2</span></span><br><span class="line">            open_file();</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">onTableRightClick</span><span class="params">(src, event, cMenu, table_data)</span></span></span><br><span class="line">        <span class="comment">% Check if the event is a right-click (button 3 is the right mouse button)</span></span><br><span class="line">        <span class="keyword">if</span> event.getButton() == <span class="number">3</span></span><br><span class="line">            <span class="comment">% Get the current pointer location (in pixels)</span></span><br><span class="line">            fig = table_data.Parent;</span><br><span class="line">            currentPoint = fig.CurrentPoint;</span><br><span class="line">            <span class="comment">% Show the context menu at the current pointer location</span></span><br><span class="line">            set(cMenu, <span class="string">&#x27;Position&#x27;</span>, currentPoint, <span class="string">&#x27;Visible&#x27;</span>, <span class="string">&#x27;on&#x27;</span>);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">copyFileOrFolderAction</span><span class="params">(jTable)</span></span></span><br><span class="line">        <span class="comment">% Get selected cell value</span></span><br><span class="line">        row = jTable.getSelectedRow() + <span class="number">1</span>; <span class="comment">% Java indices are 0-based</span></span><br><span class="line">        col = jTable.getSelectedColumn() + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> row &gt; <span class="number">0</span> &amp;&amp; col &gt; <span class="number">0</span></span><br><span class="line">            dataModel = jTable.getModel();</span><br><span class="line">            path1 = char(dataModel.getValueAt(row - <span class="number">1</span>, col - <span class="number">1</span>)); <span class="comment">% Assuming the cell contains a file/folder path</span></span><br><span class="line">            <span class="keyword">if</span> exist(path1, <span class="string">&#x27;file&#x27;</span>) || exist(path1, <span class="string">&#x27;dir&#x27;</span>) <span class="comment">% Check if it&#x27;s a valid file/folder path</span></span><br><span class="line">                <span class="comment">% Ask the user to select a destination folder</span></span><br><span class="line">                destinationFolder = uigetdir(<span class="string">&#x27;Select a destination folder&#x27;</span>);</span><br><span class="line">                <span class="keyword">if</span> destinationFolder ~= <span class="number">0</span> <span class="comment">% Ensure the user didn&#x27;t cancel the dialog</span></span><br><span class="line">                    [~, name, ext] = fileparts(path1);</span><br><span class="line">                    destinationPath = fullfile(destinationFolder, <span class="string">&#x27;/&#x27;</span>); <span class="comment">% Construct the destination path</span></span><br><span class="line">                    <span class="keyword">try</span></span><br><span class="line">                        <span class="comment">% Attempt to copy the file or folder</span></span><br><span class="line">                        copyfile([path path1], destinationPath);</span><br><span class="line"><span class="comment">%                         msgbox(&#x27;Copy successful!&#x27;, &#x27;Success&#x27;);</span></span><br><span class="line">                    <span class="keyword">catch</span></span><br><span class="line">                        errordlg(<span class="string">&#x27;Failed to copy the selected file/folder.&#x27;</span>, <span class="string">&#x27;Error&#x27;</span>);</span><br><span class="line">                    <span class="keyword">end</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                errordlg(<span class="string">&#x27;The selected cell does not contain a valid file/folder path.&#x27;</span>, <span class="string">&#x27;Error&#x27;</span>);</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">openFolderPathAction</span><span class="params">()</span></span></span><br><span class="line">        <span class="comment">% Open user&#x27;s home directory for demonstration. Replace this path with</span></span><br><span class="line">        <span class="comment">% the one you&#x27;d like to open based on your application&#x27;s logic.</span></span><br><span class="line">        <span class="keyword">if</span> ispc</span><br><span class="line">            folderPath = getenv(<span class="string">&#x27;USERPROFILE&#x27;</span>); <span class="comment">% Works on Windows;</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            folderPath = getenv(<span class="string">&#x27;HOME&#x27;</span>);<span class="comment">% on Linux/Mac</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span> isfolder(folderPath)</span><br><span class="line">            <span class="comment">% Open the folder</span></span><br><span class="line">            web([<span class="string">&#x27;file:///&#x27;</span>, path], <span class="string">&#x27;-browser&#x27;</span>);</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">%     function showPropertiesAction(jTable)</span></span><br><span class="line"><span class="comment">%         % Get selected cell info</span></span><br><span class="line"><span class="comment">%         row = jTable.getSelectedRow() + 1;</span></span><br><span class="line"><span class="comment">%         col = jTable.getSelectedColumn() + 1;</span></span><br><span class="line"><span class="comment">%         if row &gt; 0 &amp;&amp; col &gt; 0</span></span><br><span class="line"><span class="comment">%             dataModel = jTable.getModel();</span></span><br><span class="line"><span class="comment">%             value = dataModel.getValueAt(row - 1, col - 1); % Java is 0-based</span></span><br><span class="line"><span class="comment">%             % Display properties</span></span><br><span class="line"><span class="comment">%             msgbox(sprintf(&#x27;Row: %d\nColumn: %d\nValue: %s&#x27;, row, col, num2str(value)), &#x27;Cell Properties&#x27;);</span></span><br><span class="line"><span class="comment">%         end</span></span><br><span class="line"><span class="comment">%     end</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">open_file</span><span class="params">(~, ~)</span></span></span><br><span class="line">        selected_index = get(table_data, <span class="string">&#x27;UserData&#x27;</span>);</span><br><span class="line">        selected_index2 = get(table_dataFilter, <span class="string">&#x27;UserData&#x27;</span>);</span><br><span class="line">        <span class="keyword">if</span> ~<span class="built_in">isempty</span>(selected_index)</span><br><span class="line">            <span class="comment">% Get the file path of the selected row</span></span><br><span class="line">            file_path = table_data.Data&#123;selected_index, <span class="number">5</span>&#125;;</span><br><span class="line">            <span class="keyword">if</span> ispc</span><br><span class="line">                winopen(file_path);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                system([<span class="string">&#x27;open &#x27;</span>, file_path]); <span class="comment">% For macOS and Linux</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">elseif</span> ~<span class="built_in">isempty</span>(selected_index2)</span><br><span class="line">             file_path = pathIndex&#123;selected_index2&#125;;</span><br><span class="line">                [~, ~, ext] = fileparts(file_path);</span><br><span class="line">                lineNumber = line_number(selected_index2);</span><br><span class="line">                <span class="keyword">if</span> strcmp(ext, <span class="string">&#x27;.m&#x27;</span>)</span><br><span class="line">                    edit(file_path);</span><br><span class="line">                    pause(<span class="number">0.1</span>); <span class="comment">% Wait for the file to open</span></span><br><span class="line">                    matlab.desktop.editor.getActive().goToLine(lineNumber);</span><br><span class="line">                <span class="keyword">elseif</span> strcmp(ext, <span class="string">&#x27;.txt&#x27;</span>)</span><br><span class="line">                    open(file_path);</span><br><span class="line">                    pause(<span class="number">0.1</span>); <span class="comment">% Wait for the file to open</span></span><br><span class="line">                    com.mathworks.mde.editor.EditorUtils.scrollToLine(lineNumber);</span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">return</span>; <span class="comment">% No file selected</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mb</span> = <span class="title">bytes2mb</span><span class="params">(bytes)</span></span></span><br><span class="line">    <span class="comment">% Convert bytes to megabytes</span></span><br><span class="line">    mb = bytes / (<span class="number">1024</span> ^ <span class="number">2</span>);</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>





]]></content>
      <tags>
        <tag>Matlab graphics</tag>
      </tags>
  </entry>
  <entry>
    <title>Latex Tips</title>
    <url>/2023/08/08/Tips/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h3 id="Using-braces-to-label-parts-of-an-equation"><a href="#Using-braces-to-label-parts-of-an-equation" class="headerlink" title="Using braces to label parts of an equation"></a>Using braces to label parts of an equation</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\[</span><span class="keyword">\Theta</span><span class="built_in">^</span>+ = <span class="keyword">\underbrace</span>&#123;<span class="keyword">\int</span><span class="built_in">_</span>0<span class="built_in">^</span>&#123;z<span class="built_in">_</span>&#123;crit&#125;<span class="built_in">^</span>+&#125;<span class="keyword">\frac</span>&#123;dz<span class="built_in">^</span>+&#125;&#123;1/Pr +<span class="keyword">\alpha</span><span class="built_in">_</span>t/<span class="keyword">\nu</span>&#125;&#125;<span class="built_in">_</span>&#123;<span class="keyword">\Romannum</span>&#123;1&#125;&#125; + <span class="keyword">\underbrace</span>&#123;<span class="keyword">\int</span><span class="built_in">_</span>&#123;z<span class="built_in">_</span>&#123;crit&#125;<span class="built_in">^</span>+&#125;<span class="built_in">^</span>&#123;z<span class="built_in">^</span>+&#125;<span class="keyword">\frac</span>&#123;dz<span class="built_in">^</span>+&#125;&#123;1/Pr +<span class="keyword">\alpha</span><span class="built_in">_</span>t/<span class="keyword">\nu</span>&#125;&#125;<span class="built_in">_</span>&#123;<span class="keyword">\Romannum</span>&#123;2&#125;&#125;<span class="keyword">\]</span></span><br></pre></td></tr></table></figure>

<figure>
    <img src="/2023/08/08/Tips/underbrace.png" style="width:400px; text-align:center" alt="underbrace type" title="title">
</figure>


<span id="more"></span> 


<h3 id="Get-Roman-numerals-in-text"><a href="#Get-Roman-numerals-in-text" class="headerlink" title="Get Roman numerals in text"></a>Get Roman numerals in text</h3><ol>
<li><p>install the package of “romannum”</p>
</li>
<li><p>type <code>\usepackage&#123;romannum&#125;</code>in the text</p>
</li>
<li><p><code>\romannum&#123;1&#125;</code> for Lowercase roman numbers or <code>\Romannum&#123;1&#125;</code> for Uppercase roman numbers</p>
</li>
</ol>
<h3 id="Setting-‘Fill-Anywhere’-command-in-Latexing-package-in-Sublime"><a href="#Setting-‘Fill-Anywhere’-command-in-Latexing-package-in-Sublime" class="headerlink" title="Setting  ‘Fill Anywhere’  command in Latexing package  in Sublime"></a>Setting  ‘Fill Anywhere’  command in Latexing package  in Sublime</h3><p>The fill anywhere command is providing the <strong>filling</strong> that a drop down menu will let you choose what you would like to do at the current selection. For example it could be required to fill a image path somewhere else then just the normal <code>\includegraphics</code> command. The fill anywhere command is available for <code>\include</code>, <code>\input</code>, <code>\subfile</code>. <code>\includegraphics</code>, <code>\ref</code>, <code>\cite</code>, and <code>\ac</code> commands and there mutations like usual.</p>
<p>It is suggested to set the key binding as follows to make it handy.</p>
<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">       &quot;keys&quot;: [&quot;ctrl+shift+alt+z&quot;],</span><br><span class="line">       &quot;command&quot;: &quot;ltx<span class="built_in">_</span>fill<span class="built_in">_</span>anywhere&quot;,</span><br><span class="line">       &quot;context&quot;: [</span><br><span class="line">           &#123;&quot;key&quot;: &quot;selection<span class="built_in">_</span>empty&quot;, &quot;match<span class="built_in">_</span>all&quot;: true, &quot;operand&quot;: true, &quot;operator&quot;: &quot;equal&quot;&#125;,</span><br><span class="line">           &#123;&quot;key&quot;: &quot;selector&quot;, &quot;operand&quot;: &quot;text.tex.latex&quot;, &quot;operator&quot;: &quot;equal&quot;&#125;</span><br><span class="line">       ]</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="Two-statements-using-curly-brace-in-an-equation"><a href="#Two-statements-using-curly-brace-in-an-equation" class="headerlink" title="Two statements using curly brace in an equation"></a>Two statements using curly brace in an equation</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\usepackage</span>&#123;amsmath&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;equation&#125;</span><br><span class="line">  f(x)=<span class="keyword">\begin</span>&#123;cases&#125;</span><br><span class="line">    1, <span class="built_in">&amp;</span> <span class="keyword">\text</span>&#123;if <span class="built_in">$</span>x&lt;0<span class="built_in">$</span>&#125;.<span class="keyword">\\</span></span><br><span class="line">    0, <span class="built_in">&amp;</span> <span class="keyword">\text</span>&#123;otherwise&#125;.</span><br><span class="line">  <span class="keyword">\end</span>&#123;cases&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;equation&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<figure>
    <img src="/2023/08/08/Tips/eqn1.png" style="width:400px; text-align:center" alt="equation format" title="title">
</figure>



<figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line">This is your only binary choices</span><br><span class="line"><span class="keyword">\begin</span>&#123;math&#125;</span><br><span class="line">  <span class="keyword">\left</span><span class="keyword">\&#123;</span></span><br><span class="line">    <span class="keyword">\begin</span>&#123;array&#125;&#123;l&#125;</span><br><span class="line">      0<span class="keyword">\\</span></span><br><span class="line">      1</span><br><span class="line">    <span class="keyword">\end</span>&#123;array&#125;</span><br><span class="line">  <span class="keyword">\right</span>.</span><br><span class="line"><span class="keyword">\end</span>&#123;math&#125;</span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>
<figure>
    <img src="/2023/08/08/Tips/eqn2.png" style="width:400px; text-align:center" alt="equation format 2" title="title">
</figure>

<h3 id="Get-information-of-LaTex-template-through-command"><a href="#Get-information-of-LaTex-template-through-command" class="headerlink" title="Get information of LaTex template through command"></a>Get information of LaTex template through command</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\documentclass</span>&#123;article&#125;</span><br><span class="line"><span class="keyword">\makeatletter</span></span><br><span class="line"><span class="keyword">\newcommand</span><span class="keyword">\thefont</span>&#123;<span class="keyword">\expandafter</span><span class="keyword">\string</span><span class="keyword">\the</span><span class="keyword">\font</span>&#125;</span><br><span class="line"><span class="keyword">\makeatother</span></span><br><span class="line"><span class="keyword">\begin</span>&#123;document&#125;</span><br><span class="line"><span class="keyword">\thefont</span> <span class="comment">% check all attributes of font</span></span><br><span class="line"><span class="keyword">\the</span><span class="keyword">\columnwidth</span> <span class="comment">% check column width</span></span><br><span class="line"><span class="keyword">\the</span><span class="keyword">\textwidth</span>   <span class="comment">% check text width</span></span><br><span class="line"><span class="keyword">\end</span>&#123;document&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Create-a-shortcut-to-the-snippet-palette-in-Sublime-Text-3"><a href="#Create-a-shortcut-to-the-snippet-palette-in-Sublime-Text-3" class="headerlink" title="Create a shortcut to the snippet palette in Sublime Text 3"></a>Create a shortcut to the snippet palette in Sublime Text 3</h3><p>add following snippet code in <em>Preferences:Key Bindings - User</em></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line">[</span><br><span class="line">    &#123; </span><br><span class="line">        <span class="string">&quot;keys&quot;</span>: [<span class="string">&quot;ctrl+y&quot;</span>], </span><br><span class="line">        <span class="string">&quot;command&quot;</span>: <span class="string">&quot;show_overlay&quot;</span>, </span><br><span class="line">        <span class="string">&quot;args&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;overlay&quot;</span>: <span class="string">&quot;command_palette&quot;</span>, </span><br><span class="line">            <span class="string">&quot;text&quot;</span>: <span class="string">&quot;Snippet: &quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="Sublime-Text-3-LaTexTools-configuration-under-Windows"><a href="#Sublime-Text-3-LaTexTools-configuration-under-Windows" class="headerlink" title="Sublime Text 3 LaTexTools configuration under Windows"></a>Sublime Text 3 LaTexTools configuration under Windows</h3><p>The path must include &#96;ghostscript’ to execute <strong>epstopdf</strong>. Here the path is<br>  <em>C:\texlive\2020\tlpkg\tlgs\bin</em>.</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="string">&quot;windows&quot;</span>: &#123;</span><br><span class="line">        <span class="comment">// Path used when invoking tex &amp; friends; &quot;&quot; is fine for MiKTeX</span></span><br><span class="line">        <span class="comment">// For TeXlive 2011 (or other years) use</span></span><br><span class="line">         <span class="string">&quot;texpath&quot;</span> : <span class="string">&quot;C:\\texlive\\2020\\bin\\win32;C:\\texlive\\2020\\tlpkg\\tlgs\\bin;$PATH&quot;</span>,</span><br><span class="line">         <span class="comment">// C:\\texlive\\2020\\tlpkg\\tlgs\\bin offer ghostgraphics path</span></span><br><span class="line">        <span class="comment">// &quot;texpath&quot; : &quot;C:\\Program Files\\MiKTeX 2.9\\miktex\\bin\\x64;PATH&quot;,</span></span><br><span class="line">        <span class="comment">// TeX distro: &quot;miktex&quot; or &quot;texlive&quot;</span></span><br><span class="line">        <span class="comment">//&quot;distro&quot; : &quot;miktex&quot;,</span></span><br><span class="line">        <span class="string">&quot;distro&quot;</span> : <span class="string">&quot;texlive&quot;</span>,</span><br><span class="line">        <span class="comment">// Command to invoke Sumatra. If blank, &quot;SumatraPDF.exe&quot; is used (it has to be on your PATH)</span></span><br><span class="line">        <span class="string">&quot;sumatra&quot;</span>: <span class="string">&quot;C:\\Program Files\\SumatraPDF\\SumatraPDF.exe&quot;</span>, </span><br><span class="line">        <span class="comment">// Command to invoke Sublime Text. Used if the keep_focus toggle is true.</span></span><br><span class="line">        <span class="comment">// If blank, &quot;subl.exe&quot; or &quot;sublime_text.exe&quot; will be used.</span></span><br><span class="line">        <span class="string">&quot;sublime_executable&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="comment">// how long (in seconds) to wait after the jump_to_pdf command completes</span></span><br><span class="line">        <span class="comment">// before switching focus back to Sublime Text. This may need to be</span></span><br><span class="line">        <span class="comment">// adjusted depending on your machine and configuration.</span></span><br><span class="line">        <span class="string">&quot;keep_focus_delay&quot;</span>: <span class="number">0.5</span></span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure>
<h3 id="Striketrhough-in-LaTex"><a href="#Striketrhough-in-LaTex" class="headerlink" title="Striketrhough in LaTex"></a>Striketrhough in LaTex</h3><p><em>\usepackage[normalem]{ulem}</em> in the preamble </p>
<ol>
<li>\sout{text to be striked out} for a horizontal line through text to be striked out </li>
<li>\xout{text to be crossed out} for many short diagonal lines crossing out the letters of the text to be crossed out</li>
</ol>
<h3 id="customise-your-own-symbol-in-latex-with-TIKZ"><a href="#customise-your-own-symbol-in-latex-with-TIKZ" class="headerlink" title="customise your own symbol in latex with TIKZ"></a>customise your own symbol in latex with TIKZ</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>&#123;tikz&#125;</span><br><span class="line"><span class="keyword">\usetikzlibrary</span>&#123;shapes.geometric&#125;</span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\strikeddowntriangleFilled</span>&#125;[1]&#123;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line"><span class="keyword">\node</span>[inner sep=0pt] (triangle) at (0,0) &#123;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line">    <span class="keyword">\fill</span>[line width = <span class="params">#1</span>] (0,0) -- ++(0.55em,0) -- ++(-0.275em,0.55em) -- cycle;</span><br><span class="line">    <span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">\draw</span>[line width=<span class="params">#1</span>] (triangle.west) -- (triangle.east);</span><br><span class="line"><span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125; <span class="comment">% this generates a filled symbol with strikethrough line </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">\newcommand</span>&#123;<span class="keyword">\dcircle</span>&#125;[1]&#123;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tikzpicture&#125;[line width=<span class="params">#1</span>]</span><br><span class="line"><span class="keyword">\node</span>[inner sep=0pt,circle,minimum size=0.55em,draw] (circle) &#123;&#125;;</span><br><span class="line"><span class="keyword">\end</span>&#123;tikzpicture&#125; <span class="comment">% draw a circle with comparable size of font. </span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\DeclareRobustCommand</span>&#123;<span class="keyword">\crossdefined</span>&#125;[1]&#123;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line"><span class="keyword">\node</span>[inner sep=0pt] (cross) at (0,0) &#123;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line">    <span class="keyword">\draw</span>[line width=<span class="params">#1</span>] (0,0) -- (0.3525em,-0.3525em);</span><br><span class="line">    <span class="keyword">\draw</span>[line width=<span class="params">#1</span>] (0,-0.3525em) -- (0.3525em,0);</span><br><span class="line">    <span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\DeclareRobustCommand</span>&#123;<span class="keyword">\plusdefined</span>&#125;[1]&#123;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line"><span class="keyword">\node</span>[inner sep=0pt] (plus) at (0,0) &#123;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line">    <span class="keyword">\draw</span>[line width=<span class="params">#1</span>] (0,0) -- (0.50em,0);</span><br><span class="line">    <span class="keyword">\draw</span>[line width=<span class="params">#1</span>] (0.275em,0.275em) -- (0.275em,-0.275em);</span><br><span class="line">    <span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\DeclareRobustCommand</span>&#123;<span class="keyword">\filldowntriangle</span>&#125;[1]&#123;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line"><span class="keyword">\node</span>[inner sep=0pt] (triangle) at (0,0) &#123;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line">    <span class="keyword">\draw</span>[fill=<span class="params">#1</span>] (0,0) -- ++(0.55em,0) -- ++(-0.275em,-0.55em) -- cycle;</span><br><span class="line">    <span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">\DeclareRobustCommand</span>&#123;<span class="keyword">\filluptriangle</span>&#125;[1]&#123;</span><br><span class="line"><span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line"><span class="keyword">\node</span>[inner sep=0pt] (triangle) at (0,0) &#123;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tikzpicture&#125;</span><br><span class="line">    <span class="keyword">\draw</span>[fill=<span class="params">#1</span>] (0,0) -- ++(0.55em,0) -- ++(-0.275em,0.55em) -- cycle;</span><br><span class="line">    <span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="add-logo-in-the-beamer"><a href="#add-logo-in-the-beamer" class="headerlink" title="add logo in the beamer"></a>add logo in the beamer</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\setbeamertemplate</span>&#123;frametitle&#125;&#123;<span class="keyword">\vspace</span>&#123;6pt&#125;<span class="keyword">\hspace</span>&#123;-5pt&#125;<span class="keyword">\textbf</span>&#123;<span class="keyword">\insertframetitle</span>&#125; <span class="keyword">\hspace</span>*&#123;<span class="keyword">\fill</span>&#125;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tikzpicture&#125;[remember picture, overlay]</span><br><span class="line"><span class="keyword">\node</span> [inner sep=0pt,</span><br><span class="line">       <span class="comment">%xshift=-..., yshift=-...   % if you like to shift the image out of corner</span></span><br><span class="line">       below left] </span><br><span class="line">    at (current page.north east) &#123;<span class="keyword">\includegraphics</span>[height=0.12<span class="keyword">\paperheight</span>]&#123;unimelb-logo.png&#125;&#125;;</span><br><span class="line">    <span class="keyword">\end</span>&#123;tikzpicture&#125;</span><br><span class="line"><span class="keyword">\hspace</span>&#123;0pt&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="using-96-biblatex’-to-insert-reference"><a href="#using-96-biblatex’-to-insert-reference" class="headerlink" title="using &#96;biblatex’ to insert reference"></a>using &#96;biblatex’ to insert reference</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line">  <span class="keyword">\usepackage</span>[american]&#123;babel&#125;</span><br><span class="line">  <span class="keyword">\usepackage</span>[utf8]&#123;inputenc&#125;</span><br><span class="line">  <span class="keyword">\usepackage</span>&#123;csquotes&#125;</span><br><span class="line">  <span class="keyword">\usepackage</span>[backend=biber,style=apa,natbib=true,sorting = ynt,sortcites = true, maxcitenames = 2, date = year, uniquename=false, uniquelist=false]&#123;biblatex&#125;</span><br><span class="line">  <span class="keyword">\DeclareLanguageMapping</span>&#123;american&#125;&#123;american-apa&#125;</span><br><span class="line">  <span class="keyword">\DeclareFieldFormat</span>&#123;doi&#125;&#123;&#125;</span><br><span class="line">  <span class="keyword">\DeclareFieldFormat</span>&#123;url&#125;&#123;&#125;</span><br><span class="line">  <span class="keyword">\DeclareFieldFormat</span>&#123;issn&#125;&#123;&#125;</span><br><span class="line">  <span class="keyword">\DeclareFieldFormat</span>&#123;urldate&#125;&#123;&#125;</span><br><span class="line">  <span class="keyword">\DeclareFieldFormat</span>&#123;version&#125;&#123;&#125;</span><br><span class="line">  <span class="keyword">\renewbibmacro</span>*&#123;doi+url+urldate+issn+version&#125;&#123;&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">\addbibresource</span>&#123;referenceBitex.bib&#125; </span><br><span class="line"><span class="comment">% Make the journaltitle field a hyperlink</span></span><br><span class="line"><span class="keyword">\DeclareFieldFormat</span>[article]&#123;journaltitle&#125;&#123;<span class="keyword">\href</span>&#123;<span class="link">\thefield&#123;url&#125;</span>&#125;&#123;<span class="keyword">\textnormal</span>&#123;<span class="params">#1</span>&#125;&#125;&#125;</span><br><span class="line"><span class="comment">% Remove quotation marks around titles of papers</span></span><br><span class="line"><span class="keyword">\DeclareFieldFormat</span>[article]&#123;title&#125;&#123;<span class="params">#1</span>&#125;</span><br></pre></td></tr></table></figure>

<h3 id="using-package-cleveref"><a href="#using-package-cleveref" class="headerlink" title="using package cleveref"></a>using package <code>cleveref</code></h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\usepackage</span>[capitalize]&#123;cleveref&#125; </span><br><span class="line"><span class="keyword">\crefname</span>&#123;chapter&#125;&#123;Chapter&#125;&#123;Chapters&#125;</span><br><span class="line"><span class="keyword">\crefname</span>&#123;section&#125;&#123;Section&#125;&#123;Sections&#125;</span><br><span class="line"><span class="keyword">\AtBeginEnvironment</span>&#123;appendices&#125;&#123;<span class="keyword">\crefalias</span>&#123;chapter&#125;&#123;appendix&#125;&#125;</span><br><span class="line"><span class="keyword">\crefname</span>&#123;figure&#125;&#123;Figure&#125;&#123;Figures&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="add-footnotemark-in-table-environment"><a href="#add-footnotemark-in-table-environment" class="headerlink" title="add footnotemark in table environment"></a>add footnotemark in table environment</h3><figure class="highlight latex"><table><tr><td class="code"><pre><span class="line"><span class="keyword">\begin</span>&#123;table&#125;[!t]</span><br><span class="line">  <span class="keyword">\centering</span></span><br><span class="line">   <span class="keyword">\begin</span>&#123;threeparttable&#125; <span class="comment">% Start threeparttable environment</span></span><br><span class="line">    <span class="keyword">\caption</span>&#123;<span class="comment">%</span></span><br><span class="line">    Dual-wire sensors&#x27; dimension. </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">\label</span>&#123;tab:dual<span class="built_in">_</span>wireDimension&#125;</span><br><span class="line">    <span class="keyword">\begin</span>&#123;tabular&#125;&#123;cccccccc&#125;</span><br><span class="line">    <span class="keyword">\hline</span></span><br><span class="line">    <span class="built_in">$</span><span class="keyword">\alpha</span><span class="built_in">_</span>&#123;&#123;p&#125;&#125;<span class="built_in">$</span> <span class="built_in">&amp;</span>  <span class="built_in">$</span>d<span class="built_in">_</span><span class="keyword">\mathrm</span>&#123;hw&#125;<span class="built_in">$</span><span class="keyword">\tnote</span>&#123;*&#125;  <span class="built_in">&amp;</span> <span class="built_in">$</span>d<span class="built_in">_</span><span class="keyword">\mathrm</span>&#123;cw&#125;<span class="built_in">$</span><span class="keyword">\tnote</span>&#123;*&#125;   <span class="built_in">&amp;</span>   <span class="built_in">$</span>l<span class="built_in">_</span><span class="keyword">\mathrm</span>&#123;hw&#125;<span class="built_in">$</span> <span class="built_in">&amp;</span> <span class="built_in">$</span>l<span class="built_in">_</span><span class="keyword">\mathrm</span>&#123;cw&#125;<span class="built_in">$</span> <span class="built_in">&amp;</span>  <span class="built_in">$</span>L<span class="built_in">_</span><span class="keyword">\mathrm</span>&#123;hw&#125;<span class="built_in">$</span> <span class="built_in">&amp;</span> <span class="built_in">$</span>L<span class="built_in">_</span><span class="keyword">\mathrm</span>&#123;cw&#125;<span class="built_in">$</span> <span class="built_in">&amp;</span> <span class="built_in">$</span><span class="keyword">\Delta</span> x<span class="built_in">$</span> <span class="keyword">\\</span></span><br><span class="line">     (deg)         <span class="built_in">&amp;</span>  (<span class="built_in">$</span><span class="keyword">\mathrm</span>&#123;<span class="keyword">\upmu</span> m&#125;<span class="built_in">$</span>)  <span class="built_in">&amp;</span> (<span class="built_in">$</span><span class="keyword">\mathrm</span>&#123;<span class="keyword">\upmu</span> m&#125;<span class="built_in">$</span>) <span class="built_in">&amp;</span>  (<span class="built_in">$</span><span class="keyword">\mathrm</span>&#123;mm&#125;<span class="built_in">$</span>) <span class="built_in">&amp;</span> (<span class="built_in">$</span><span class="keyword">\mathrm</span>&#123;mm&#125;<span class="built_in">$</span>) <span class="built_in">&amp;</span> (<span class="built_in">$</span><span class="keyword">\mathrm</span>&#123;mm&#125;<span class="built_in">$</span>) <span class="built_in">&amp;</span> (<span class="built_in">$</span><span class="keyword">\mathrm</span>&#123;mm&#125;<span class="built_in">$</span>) <span class="built_in">&amp;</span> (<span class="built_in">$</span><span class="keyword">\mathrm</span>&#123;mm&#125;<span class="built_in">$</span>) <span class="keyword">\\</span></span><br><span class="line">    <span class="built_in">$</span>10<span class="built_in">$</span>           <span class="built_in">&amp;</span>        5.0             <span class="built_in">&amp;</span> 1.5                  <span class="built_in">&amp;</span>     1.36         <span class="built_in">&amp;</span>  1.37           <span class="built_in">&amp;</span>       2.0       <span class="built_in">&amp;</span> 3.3            <span class="built_in">&amp;</span> 1.6    <span class="keyword">\\</span></span><br><span class="line">    <span class="built_in">$</span>25<span class="built_in">$</span>           <span class="built_in">&amp;</span>        5.0             <span class="built_in">&amp;</span> 1.5                  <span class="built_in">&amp;</span>     1.32         <span class="built_in">&amp;</span>  1.36           <span class="built_in">&amp;</span>       1.9       <span class="built_in">&amp;</span> 3.0            <span class="built_in">&amp;</span> 1.9    <span class="keyword">\\</span></span><br><span class="line">    <span class="keyword">\hline</span></span><br><span class="line">    <span class="keyword">\end</span>&#123;tabular&#125;</span><br><span class="line">     <span class="keyword">\begin</span>&#123;tablenotes&#125;[flushleft] <span class="comment">% Start tablenotes environment with flushleft option</span></span><br><span class="line">            <span class="keyword">\item</span>[<span class="keyword">\textsuperscript</span>&#123;*&#125;] The subscript <span class="built_in">$</span><span class="built_in">_</span><span class="keyword">\mathrm</span>&#123;hw&#125;<span class="built_in">$</span> and <span class="built_in">$</span><span class="built_in">_</span><span class="keyword">\mathrm</span>&#123;cw&#125;<span class="built_in">$</span> denotes the quantity of hot-wire and cold-wire, respectively.</span><br><span class="line">        <span class="keyword">\end</span>&#123;tablenotes&#125; <span class="comment">% End tablenotes environment</span></span><br><span class="line">    <span class="keyword">\end</span>&#123;threeparttable&#125; <span class="comment">% End threeparttable environment    </span></span><br><span class="line"><span class="keyword">\end</span>&#123;table&#125;</span><br></pre></td></tr></table></figure>




]]></content>
  </entry>
  <entry>
    <title>MATLAB Tips</title>
    <url>/2023/07/24/Matlab-Tips/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><h2 id="General-Programming-Tips"><a href="#General-Programming-Tips" class="headerlink" title="General Programming Tips"></a>General Programming Tips</h2><ol>
<li><p>Compute the running time of a function all</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">tic; fft(<span class="built_in">rand</span>(<span class="number">500</span>)); <span class="built_in">disp</span>( [’it takes ’ num2str(toc) ’s.’] );</span><br></pre></td></tr></table></figure>
</li>
<li><p>Locate the indice of minimum value in a matrice</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">[M,I]         = <span class="built_in">min</span>(objMatrice(:)); <span class="comment">% &#x27;objMatrice&#x27; is the objective matrix</span></span><br><span class="line">[Irow,Icol]   = <span class="built_in">ind2sub</span>(<span class="built_in">size</span>(objMatrice),I);</span><br></pre></td></tr></table></figure></li>
</ol>
<span id="more"></span> 
<ol start="3">
<li><p>Sort ascending filenames based on number</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">sFile = dir([dir1 <span class="string">&#x27;temp*.mat&#x27;</span>]);</span><br><span class="line"><span class="comment">%%% sort ascending filenames based on Number</span></span><br><span class="line">[~, reindex] = ...</span><br><span class="line">       <span class="built_in">sort</span>(str2double(regexp( &#123;sFile.name&#125;, <span class="string">&#x27;\d+&#x27;</span>, <span class="string">&#x27;match&#x27;</span>, <span class="string">&#x27;once&#x27;</span> )));</span><br><span class="line">sFile        = sFile(reindex) ;</span><br></pre></td></tr></table></figure>

</li>
<li><p>Writing&#x2F;Reading to a text file a list of 3-uplets.</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% A is a matrix with 3 rows.</span></span><br><span class="line">fid = fopen(filename,’wt’);</span><br><span class="line">fprintf(fid, ’<span class="comment">%f %f %f\n’, A);</span></span><br><span class="line">fclose(fid); <span class="comment">% Retrieving the values back from file to matrix B.</span></span><br><span class="line">fid = fopen(filename,’r’);</span><br><span class="line">[B,cnt] = fscanf(fid,’<span class="comment">%f %f %f’);</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>Create a graphical waitbar</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">n = <span class="number">100</span>;</span><br><span class="line">h = waitbar(<span class="number">0</span>,’Waiting ...’);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:n</span><br><span class="line">waitbar(<span class="built_in">i</span>/n);</span><br><span class="line"><span class="comment">% here perform some stuff</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">close(h);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Loading issue </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="keyword">try</span></span><br><span class="line">    load(<span class="string">&#x27;xxx.mat&#x27;</span>) <span class="comment">% x</span></span><br><span class="line"><span class="keyword">catch</span> </span><br><span class="line">    datatemp = matfile(<span class="string">&#x27;xxx.mat&#x27;</span>);  <span class="comment">% x</span></span><br><span class="line">    data     = datatemp.x;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Sub-function-Tricks"><a href="#Sub-function-Tricks" class="headerlink" title="Sub-function Tricks"></a>Sub-function Tricks</h2><ol>
<li><p>Create a sub-function that takes optional arguments in a struct</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">y</span> = <span class="title">f</span><span class="params">(x,options)</span></span></span><br><span class="line"><span class="comment">% parse the struct</span></span><br><span class="line"><span class="keyword">if</span> nargin&lt;<span class="number">2</span></span><br><span class="line">options.null = <span class="number">0</span>; <span class="comment">% force creation of options</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span> isfield(options, ’a’)</span><br><span class="line">options.a = <span class="number">1</span>; <span class="comment">% default value</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">a = options.a;</span><br><span class="line"><span class="keyword">if</span> isfield(options, ’b’)</span><br><span class="line">options.b = <span class="number">1</span>; <span class="comment">% default value</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">b = options.b;</span><br><span class="line"><span class="comment">% Here the body of the function ...</span></span><br></pre></td></tr></table></figure>
<p>note: nargin returns the number of function input arguments given in the call to the currently executing function. </p>
</li>
<li><p>Use <strong>varargin</strong>  in function e.g. as following. A single function to generate two-dimensional (2D) line graphs, avoiding a long list of code for the generation of each graphic.</p>
<p><strong>PlotSet</strong> generates 2D plots, including multiple plots on a page. This code processes <strong>varargin</strong> as<br>parameter pairs to set options. This makes it easy to expand the options. You can look for more information in the following book.</p>
<p>Paluszek, M., and S. Thomas. <em>MATLAB Machine Learning</em>. Apress, 2016. <a href="https://books.google.com.au/books?id=jy75vQAACAAJ">https://books.google.com.au/books?id=jy75vQAACAAJ</a>.</p>
</li>
<li><p>Write a function fun(a,b,c) that can take an arbitrary number of arguments</p>
 <figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span><span class="params">(args)</span></span></span><br><span class="line">default_values = &#123;<span class="number">0.1246</span>,<span class="number">1.2346</span>,<span class="number">8.7643</span>&#125;;</span><br><span class="line">args_present = <span class="built_in">cellfun</span>(@<span class="built_in">isempty</span>,args);</span><br><span class="line">default_values(args_present) = args(args_present);</span><br><span class="line">[a b c] = deal(default_values);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Load a variable from a .mat file and then place that variable inside a structure with the same name</p>
 <figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">% Load the variable</span><br><span class="line">loadedData = load(&#x27;myData.mat&#x27;);  % This loads the data into a structure</span><br><span class="line"></span><br><span class="line">% Extract field names from the loaded data</span><br><span class="line">fieldNames = fieldnames(loadedData);</span><br><span class="line"></span><br><span class="line">% Loop through each variable and assign it to a new structure with the same name</span><br><span class="line">for k = 1:length(fieldNames)</span><br><span class="line">    varName = fieldNames&#123;k&#125;;</span><br><span class="line">    dataStruct.(varName) = loadedData.(varName);</span><br><span class="line">end</span><br><span class="line">% Now dataStruct has fields corresponding to the variables loaded from the .mat file</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Mathematical-Tips"><a href="#Mathematical-Tips" class="headerlink" title="Mathematical Tips"></a>Mathematical Tips</h2><ol>
<li><p>Generate n points x sampled uniformly at random on a sphere.</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">% tensor product gaussian is isotropic</span></span><br><span class="line">x = <span class="built_in">randn</span>(<span class="number">3</span>,n);</span><br><span class="line">d = <span class="built_in">sqrt</span>( x(<span class="number">1</span>,:).ˆ<span class="number">2</span>+x(<span class="number">2</span>,:).ˆ<span class="number">2</span>+x(<span class="number">2</span>,:).ˆ<span class="number">2</span> );</span><br><span class="line">x(<span class="number">1</span>,:) = x(<span class="number">1</span>,:)./d;</span><br><span class="line">x(<span class="number">2</span>,:) = x(<span class="number">2</span>,:)./d;</span><br><span class="line">x(<span class="number">3</span>,:) = x(<span class="number">3</span>,:)./d;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Keep only the n biggest coefficients of a signal x (set the others to 0).</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">[tmp,I] = <span class="built_in">sort</span>(<span class="built_in">abs</span>(x(:))); x( I(<span class="number">1</span>:<span class="keyword">end</span>-n) ) = <span class="number">0</span>;</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Plotting"><a href="#Plotting" class="headerlink" title="Plotting"></a>Plotting</h2><ol>
<li><p>Draw a 3D sphere.</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">p = <span class="number">20</span>; <span class="comment">% precision</span></span><br><span class="line">t = <span class="number">0</span>:<span class="number">1</span>/(p<span class="number">-1</span>):<span class="number">1</span>;</span><br><span class="line">[th,ph] = <span class="built_in">meshgrid</span>( t*<span class="built_in">pi</span>,t*<span class="number">2</span>*<span class="built_in">pi</span> );</span><br><span class="line">x = <span class="built_in">cos</span>(th);</span><br><span class="line">y = <span class="built_in">sin</span>(th).*<span class="built_in">cos</span>(ph);</span><br><span class="line">z = <span class="built_in">sin</span>(th).*<span class="built_in">sin</span>(ph);</span><br><span class="line">surf(x,y,z, z.*<span class="number">0</span>);</span><br><span class="line"><span class="comment">% some pretty rendering options</span></span><br><span class="line">shading interp; lighting gouraud;</span><br><span class="line">camlight infinite; axis square; axis off;</span><br></pre></td></tr></table></figure>
</li>
<li><p>Edit legend</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">[hhLeg,labelhandles] = <span class="built_in">legend</span>(ax(<span class="number">1</span>),htext,<span class="string">&#x27;location&#x27;</span>,<span class="string">&#x27;NorthEast&#x27;</span>...</span><br><span class="line">    ,<span class="string">&#x27;box&#x27;</span>,<span class="string">&#x27;off&#x27;</span>,<span class="string">&#x27;Interpreter&#x27;</span>,<span class="string">&#x27;LaTex&#x27;</span>,<span class="string">&#x27;FontSize&#x27;</span>,fS);</span><br><span class="line"><span class="comment">% hhLeg.ItemTokenSize =[20 18];</span></span><br><span class="line">labelhandles(<span class="number">5</span>).LineStyle = <span class="string">&#x27;-&#x27;</span>;</span><br><span class="line">labelhandles(<span class="number">4</span>).XData = [<span class="number">0.24</span> <span class="number">0.37</span>];</span><br><span class="line">labelhandles(<span class="number">5</span>).XData = labelhandles(<span class="number">4</span>).XData;</span><br><span class="line">labelhandles(<span class="number">4</span>).YData = labelhandles(<span class="number">4</span>).YData + <span class="number">0.07</span>;</span><br><span class="line">labelhandles(<span class="number">5</span>).YData = labelhandles(<span class="number">4</span>).YData - <span class="number">0.14</span>;</span><br><span class="line">labelhandles(<span class="number">5</span>).Color = col2(<span class="number">1</span>,:);</span><br></pre></td></tr></table></figure>
</li>
<li><p>Copy all properties for Axes</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">ax(<span class="number">2</span>) = axes(<span class="string">&#x27;Position&#x27;</span>,ax(<span class="number">1</span>).Position ...</span><br><span class="line">                       ,<span class="string">&#x27;OuterPosition&#x27;</span>,ax(<span class="number">1</span>).OuterPosition ...</span><br><span class="line">                       ,<span class="string">&#x27;InnerPosition&#x27;</span>,ax(<span class="number">1</span>).InnerPosition ...</span><br><span class="line">                       ,<span class="string">&#x27;ActivePositionProperty&#x27;</span>,ax(<span class="number">1</span>).ActivePositionProperty...</span><br><span class="line">                       ,<span class="string">&#x27;ALim&#x27;</span>,ax(<span class="number">1</span>).ALim...</span><br><span class="line">                       ,<span class="string">&#x27;ALimMode&#x27;</span>,ax(<span class="number">1</span>).ALimMode...</span><br><span class="line">                       ,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;none&#x27;</span>...</span><br><span class="line">                       ,<span class="string">&#x27;xtick&#x27;</span>,[],<span class="string">&#x27;ytick&#x27;</span>,[],<span class="string">&#x27;ztick&#x27;</span>,[]...</span><br><span class="line">                       ,<span class="string">&#x27;xcolor&#x27;</span>,<span class="string">&#x27;none&#x27;</span>,<span class="string">&#x27;ycolor&#x27;</span>,<span class="string">&#x27;none&#x27;</span>,<span class="string">&#x27;zcolor&#x27;</span>,<span class="string">&#x27;none&#x27;</span>...</span><br><span class="line">                       ,<span class="string">&#x27;Projection&#x27;</span>,<span class="string">&#x27;perspective&#x27;</span>...</span><br><span class="line">                       ,<span class="string">&#x27;CameraPosition&#x27;</span>,ax(<span class="number">1</span>).CameraPosition ...</span><br><span class="line">                       ,<span class="string">&#x27;CameraPositionMode&#x27;</span>,ax(<span class="number">1</span>).CameraPositionMode...</span><br><span class="line">                       ,<span class="string">&#x27;CameraTarget&#x27;</span>,ax(<span class="number">1</span>).CameraTarget...</span><br><span class="line">                       ,<span class="string">&#x27;CameraTargetMode&#x27;</span>,ax(<span class="number">1</span>).CameraTargetMode...</span><br><span class="line">                       ,<span class="string">&#x27;CameraUpVector&#x27;</span>,ax(<span class="number">1</span>).CameraUpVector...</span><br><span class="line">                       ,<span class="string">&#x27;CameraUpVectorMode&#x27;</span>,ax(<span class="number">1</span>).CameraUpVectorMode...</span><br><span class="line">                       ,<span class="string">&#x27;CameraViewAngle&#x27;</span>,ax(<span class="number">1</span>).CameraViewAngle...</span><br><span class="line">                       ,<span class="string">&#x27;CameraViewAngleMode&#x27;</span>,ax(<span class="number">1</span>).CameraViewAngleMode...</span><br><span class="line">                       ,<span class="string">&#x27;DataAspectRatio&#x27;</span>,ax(<span class="number">1</span>).DataAspectRatio...</span><br><span class="line">                       ,<span class="string">&#x27;DataAspectRatioMode&#x27;</span>,ax(<span class="number">1</span>).DataAspectRatioMode...</span><br><span class="line">                       );</span><br><span class="line">                   </span><br><span class="line"><span class="comment">%      copyaxes(ax(1),ax(2))</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>set handle in a figure invisible </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">set(findall(hFig,<span class="string">&#x27;Type&#x27;</span>,<span class="string">&#x27;arrow&#x27;</span>),<span class="string">&#x27;visible&#x27;</span>,<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">set(findall(hFig,<span class="string">&#x27;Type&#x27;</span>,<span class="string">&#x27;textbox&#x27;</span>),<span class="string">&#x27;visible&#x27;</span>,<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">set(findall(hFig,<span class="string">&#x27;Type&#x27;</span>,<span class="string">&#x27;axes&#x27;</span>),<span class="string">&#x27;visible&#x27;</span>,<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">set(findall(hFig,<span class="string">&#x27;Type&#x27;</span>,<span class="string">&#x27;surf&#x27;</span>),<span class="string">&#x27;visible&#x27;</span>,<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">set(findall(hFig,<span class="string">&#x27;Type&#x27;</span>,<span class="string">&#x27;patch&#x27;</span>),<span class="string">&#x27;visible&#x27;</span>,<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">set(findall(hFig,<span class="string">&#x27;Type&#x27;</span>,<span class="string">&#x27;Line&#x27;</span>),<span class="string">&#x27;visible&#x27;</span>,<span class="string">&#x27;off&#x27;</span>)</span><br><span class="line">set(findall(hFig,<span class="string">&#x27;Type&#x27;</span>,<span class="string">&#x27;contour&#x27;</span>),<span class="string">&#x27;visible&#x27;</span>,<span class="string">&#x27;off&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>plot at a specific plane </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">tt = hgtransform(ax(<span class="number">2</span>)); <span class="comment">% establish plane </span></span><br><span class="line"><span class="comment">% X-axis rotation matrix and Z-axis translation matrix</span></span><br><span class="line">Rz = makehgtform(<span class="string">&#x27;translate&#x27;</span>,[<span class="number">0</span> y(<span class="keyword">end</span>) <span class="number">0</span>],<span class="string">&#x27;xrotate&#x27;</span>,<span class="number">1</span>/<span class="number">2</span>*<span class="built_in">pi</span>,<span class="string">&#x27;yrotate&#x27;</span>,<span class="number">-1</span>/<span class="number">2</span>*<span class="built_in">pi</span>);</span><br><span class="line">set(tt,<span class="string">&#x27;Matrix&#x27;</span>,Rz);  </span><br></pre></td></tr></table></figure>
</li>
<li><p>Two axes in one figure</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">ax(<span class="number">1</span>) = axes(<span class="string">&#x27;box&#x27;</span>,<span class="string">&#x27;on&#x27;</span>);<span class="built_in">hold</span>(ax(<span class="number">1</span>),<span class="string">&#x27;on&#x27;</span>)</span><br><span class="line">ax(<span class="number">2</span>) = axes(<span class="string">&#x27;Position&#x27;</span>,ax(<span class="number">1</span>).Position ...</span><br><span class="line">              ,<span class="string">&#x27;color&#x27;</span>,<span class="string">&#x27;none&#x27;</span>...</span><br><span class="line">              ,<span class="string">&#x27;yAxisLocation&#x27;</span>,<span class="string">&#x27;right&#x27;</span>...</span><br><span class="line">              ,<span class="string">&#x27;box&#x27;</span>,<span class="string">&#x27;off&#x27;</span>...</span><br><span class="line">              ,<span class="string">&#x27;xTick&#x27;</span>,[]...</span><br><span class="line">              ...,<span class="string">&#x27;ytickLabel&#x27;</span>,[]...</span><br><span class="line">              ,<span class="string">&#x27;ycolor&#x27;</span>,[<span class="number">0.5</span> <span class="number">0.5</span> <span class="number">0.5</span>]...</span><br><span class="line">              );</span><br><span class="line"><span class="built_in">hold</span>(ax(<span class="number">2</span>),<span class="string">&#x27;on&#x27;</span>)          </span><br></pre></td></tr></table></figure>
</li>
<li><p>Iso-contours </p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line">[cContourMap,hContourMap] = contourf(gca,XXAB&#x27;,YYAB&#x27;,ZZAB&#x27;);</span><br><span class="line">set(hContourMap,<span class="string">&#x27;linestyle&#x27;</span>,<span class="string">&#x27;none&#x27;</span>)</span><br><span class="line">yclimColorbar = [<span class="number">0</span> <span class="number">1</span>];</span><br><span class="line">ytickColorbar = <span class="number">0</span>:<span class="number">0.2</span>:<span class="number">1</span>;</span><br><span class="line">colLevelist   = <span class="number">0</span>:<span class="number">0.1</span>:<span class="number">1</span>;</span><br><span class="line">hContourMap.LevelList = colLevelist;</span><br><span class="line">set(gca,<span class="string">&#x27;clim&#x27;</span>,yclimColorbar)</span><br><span class="line">hColorbar    = colorbar(gca);</span><br><span class="line">titleindex    = <span class="string">&#x27;title&#x27;</span>;</span><br><span class="line">set(get(hColorbar1,<span class="string">&#x27;title&#x27;</span>),<span class="string">&#x27;string&#x27;</span>...</span><br><span class="line">       ,titleindex...</span><br><span class="line">       ,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">11</span> ...</span><br><span class="line">       ,<span class="string">&#x27;interpreter&#x27;</span>,<span class="string">&#x27;LaTex&#x27;</span>...</span><br><span class="line">       ,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span> ...</span><br><span class="line">       )</span><br><span class="line">set(hColorbar1...</span><br><span class="line">       ,<span class="string">&#x27;ylim&#x27;</span>,yclimColorbar...</span><br><span class="line">       ...,<span class="string">&#x27;ylim&#x27;</span>,[<span class="number">0</span> <span class="number">4</span>]...</span><br><span class="line">       ,<span class="string">&#x27;ytick&#x27;</span>,ytickColorbar...</span><br><span class="line">       ,<span class="string">&#x27;Location&#x27;</span>,<span class="string">&#x27;southoutside&#x27;</span>...</span><br><span class="line">       ... ,<span class="string">&#x27;AxisLocation&#x27;</span>,<span class="string">&#x27;out&#x27;</span>...</span><br><span class="line">       ,<span class="string">&#x27;Units&#x27;</span>,<span class="string">&#x27;Normalized&#x27;</span>...</span><br><span class="line">       ...,<span class="string">&#x27;Position&#x27;</span>,[<span class="number">0.1</span> <span class="number">0.2</span> <span class="number">0.6</span> <span class="number">0.03</span>] ...</span><br><span class="line">       ,<span class="string">&#x27;FontSize&#x27;</span>,<span class="number">11</span> ...</span><br><span class="line">       ,<span class="string">&#x27;FontName&#x27;</span>,<span class="string">&#x27;Times New Roman&#x27;</span> ...</span><br><span class="line">       )</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
]]></content>
      <tags>
        <tag>Matlab graphics</tag>
      </tags>
  </entry>
  <entry>
    <title>PowerPoint</title>
    <url>/2020/06/01/Powerpoint/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>Before presentation, slides have to be prepared to deliver your ideas more precisely. One of things in the process of making slides is to add pictures in your case.</p>
<p> It is annoying to do this work from your storage if have a large number of pictures added. Here, we introduce a good way to establish connection between PowerPoint and Matlab  to help us import images quickly.</p>
<span id="more"></span> 

<p><a href="https://github.com/stefslon/exportToPPTX"><strong>exportToPPTX</strong></a>  allows user to create PowrPoint files without using COM-objects automation.</p>
<p>The example of  code is shown below.</p>
<figure class="highlight matlab"><table><tr><td class="code"><pre><span class="line"><span class="comment">%% Open a slide named &#x27;example.PPTX&#x27; </span></span><br><span class="line">exportToPPTX(<span class="string">&#x27;open&#x27;</span>,<span class="string">&#x27;example&#x27;</span>);</span><br><span class="line"><span class="comment">%% Add images in a new slide</span></span><br><span class="line">slideId     = exportToPPTX(<span class="string">&#x27;addslide&#x27;</span>);</span><br><span class="line"><span class="comment">% Upper left corner picture with a blue frame inserted via figure handle</span></span><br><span class="line">load earth; <span class="built_in">figure</span>(<span class="string">&#x27;Renderer&#x27;</span>,<span class="string">&#x27;zbuffer&#x27;</span>); image(X); colormap(map); axis off;</span><br><span class="line">exportToPPTX(<span class="string">&#x27;addpicture&#x27;</span>,gcf,<span class="string">&#x27;Position&#x27;</span>,[<span class="number">1</span> <span class="number">1</span> <span class="number">3</span> <span class="number">2</span>],<span class="string">&#x27;EdgeColor&#x27;</span>,[<span class="number">0</span> <span class="number">0</span> <span class="number">0.8</span>],<span class="string">&#x27;LineWidth&#x27;</span>,<span class="number">3</span>); <span class="comment">%</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

]]></content>
  </entry>
  <entry>
    <title>Git notes</title>
    <url>/2020/02/14/Git-notes/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><ul>
<li><p><input disabled type="checkbox"> 
Fatal: refusing to merge unrelated histories</p>
<p>using “git merge” that allows merging two branches(e.g. remote branches and local branches) that have no common base by default.</p>
 <span id="more"></span> 

<p><strong>git merge –allow-unrelated-histories</strong> to force the merge to happen</p>
</li>
<li><p><input disabled type="checkbox"> 
Undo changes &#x2F; used for operate wrongly<br>  “git reset” has three primary forms of invocation. –soft, –mixed, –hard.<br>  git reset is similar in behavior to git checkout, where git checkout solely operates on the HEAD of ref pointer, however, git reset will move the HEAD ref pointer and the current branch ref pointer.</p>
<figure>
  <img src="/2020/02/14/Git-notes/git-sequence-transparent1.png" style="width:400px; text-align:center" alt="commits on the master branch" title="title">
  <figcaption><p style="text-align:center">example of a sequence of commits</p></figcaption>
</figure>
git checkout b
<figure>
  <img src="/2020/02/14/Git-notes/git-checkout-transparent2.png" style="width:400px; text-align:center" alt="git checkout b" title="title2">
</figure>
git reset b
<figure>
  <img src="/2020/02/14/Git-notes/git-checkout-transparent3.png" style="width:300px; text-align:center" alt="git reset b" title="title3">
</figure></li>
</ul>
<h3 id="Main-options"><a href="#Main-options" class="headerlink" title="Main options"></a>Main options</h3><h4 id="–hard"><a href="#–hard" class="headerlink" title="–hard"></a>–hard</h4><p>the most direct, <em>DANGEROUS</em>, and frequently used option</p>
<h4 id="–mixed"><a href="#–mixed" class="headerlink" title="–mixed"></a>–mixed</h4><p>the stagin index is reset to the state of the specified commit</p>
<h4 id="–soft"><a href="#–soft" class="headerlink" title="–soft"></a>–soft</h4><p>head in the commit History can change</p>
<figure>
    <img src="/2020/02/14/Git-notes/option.png" style="width:400px; text-align:center" alt="git reset b" title="title3">
</figure>
]]></content>
  </entry>
  <entry>
    <title>Research Assistant - Zotero</title>
    <url>/2020/02/14/Zotero/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>科研的旅途中，需要阅读大量的论文，海量的论文无疑使得管理文献的工作变得非常复杂，尤其是因为命名方法的不恰当，导致后期再次阅读时查找困难。我看到部分学者喜欢使用<strong>author</strong>,<strong>year</strong>,<strong>title</strong>的组合方式命名文献如下图，然后存储至一固定文件夹中，以此管理文献。</p>
 <span id="more"></span> 

<p>这样的方式固然方便，但同时文件名中所含的信息太少，当论文过多时，在搜索时极易引起混乱，因此不利于管理。</p>
<p><img src="/2020/02/14/Zotero/Annotation.png" alt="Annotation"></p>
<p>如今，各类文献管理软件的兴起，如<a href="https://www-mendeley-com.ezp.lib.unimelb.edu.au/?interaction_required=true">Mendeley</a>，<a href="https://endnote.com/">Endnote</a>，<a href="https://www.zotero.org/">Zotero</a> 以及国产软件<a href="http://www.inoteexpress.com/index.htm">NoteExpress</a>等，使得论文管理有了一个比较好的提升。笔者目前使用较多是<strong>Zotero</strong>，这里着重介绍这一软件的入门使用，其中包括笔者文章引用过程中的一些小技巧以及如何结合<strong>Latex</strong>快速生成论文的参考文献。</p>
<h2 id="Zotero的安装"><a href="#Zotero的安装" class="headerlink" title="Zotero的安装"></a>Zotero的安装</h2><p><a href="https://www.zotero.org/">Zotero</a> 安装完成后，推荐注册，方便在云端同步文献库。通过<strong>Edit</strong>&gt;&gt;<strong>Preferences</strong>&gt;&gt;<strong>Sync</strong> 确认是否登录。考虑到软件仅免费提供约100MB的空间，所以建议取消<em>Sync full-text context</em>选项， 这样不会同步全文，节省空间。完成这一步后，如果使用firefox 浏览器，可以安装相应的插件便于以后的文献插入。</p>
<h2 id="Zotero的文献导入"><a href="#Zotero的文献导入" class="headerlink" title="Zotero的文献导入"></a>Zotero的文献导入</h2><p>Zotero的文献导入途径很多，经过笔者多年的测试，推荐使用以下方法。简单来说是<em>google scholar</em> + <em>firefox</em>结合。</p>
<p>通过google scholar等途径可获取文献网址数据库(如springer, Elsevier等)后，可进入下载页面，如下图所示。</p>
<figure>
    <img src="/2020/02/14/Zotero/paper_title.png" style="width:500px; text-align:center" alt="git reset b" title="title">
</figure>
点击 <u>download</u> 可进入下载页面，此时会发现zotero在firefox上的对应插件已经点亮，点击后，即发现参考文献已经导入Zotero软件中。 如果没有下载权限，也可点击<u>Export</u>，选择对应的文献管理软件即可。这里需要说明的是 Endnote 和 Mendeley 使用人数较多，所以很多数据库通常会默认选择这两个软件所支持的参考文献格式如Ref, Ris 等。但Zotero几乎支持上述所有的格式，所以任意选择一个即可。浏览器插件会自动检测是否需要导入参考文献。

<h2 id="Zotero导出BibTex"><a href="#Zotero导出BibTex" class="headerlink" title="Zotero导出BibTex"></a>Zotero导出BibTex</h2><p><strong>Microsoft Word</strong>, <strong>Libre Office</strong> 可以通过插件使用 Zotero，具体方法请参照官网，这里不在做详细说明。鉴于排版的需求，建议使用Latex编辑论文。这里介绍两种方法导出BibTex文件。</p>
<h3 id="直接导入"><a href="#直接导入" class="headerlink" title="直接导入"></a>直接导入</h3><ol>
<li>选择需要导入的文献， <strong>Ctrl</strong>+左键，可选择多个文献.</li>
<li>右击已选择的项目并选择 ‘Export Items’.</li>
<li>改变输出格式为 ‘BibLaTex’ 或者 ‘BibTex’.</li>
<li>保持默认选项或者使得 ‘Export Notes’被选择.</li>
<li>点击Ok，即可生成 ‘.bib’ 文件.</li>
</ol>
<h3 id="使用Better-BibTex插件导入"><a href="#使用Better-BibTex插件导入" class="headerlink" title="使用Better BibTex插件导入"></a>使用Better BibTex插件导入</h3><p><a href="https://retorque.re/zotero-better-bibtex/installation/">Better BibTex</a> 使得 ‘.bib’文件保持与Zotero数据库的同步更新，并且便于使用定制的<strong>Citation Key</strong> 。使用方法，可参考<a href="https://guides.library.iit.edu/c.php?g=720120&p=6296986">https://guides.library.iit.edu/c.php?g=720120&amp;p=6296986</a> </p>
<h4 id="改变Better-BibTex-Export"><a href="#改变Better-BibTex-Export" class="headerlink" title="改变Better BibTex Export"></a>改变Better BibTex Export</h4><p>有时为了保持文献格式的一致性，我们需要省略参考文献中的一些内容比如urldate, issue 等等<br>具体可以在Better BibTex <strong>setting</strong> 里面 修改 Export -&gt; Fields -&gt; Fields to omit from export (comma-separated) <code>abstract,file,urldate,editor,issue,extra,doi,issn,number</code></p>
]]></content>
      <categories>
        <category>research</category>
      </categories>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/2020/02/04/hello-world/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
 <span id="more"></span> 

<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
]]></content>
  </entry>
  <entry>
    <title>Inkscape Tricks</title>
    <url>/2020/01/20/Inkscape-Tricks/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>Some tricks are listed in the following to help get speed up with this software.</p>
 <span id="more"></span> 

<h2 id="Clipping"><a href="#Clipping" class="headerlink" title="Clipping"></a>Clipping</h2><p>由于inkscape没有直接的剪切功能，这里提供一种简单的方式仅供参考。</p>
<ol>
<li>选择你想剪切的图片(object 1)，并使用group功能，在菜单中选择 <em>Object &gt; Group</em> 。</li>
<li>在刚选择的group上，画一个想要剪切的图形(如矩形，圆等)，object 2。</li>
<li>选择object 1 and object 2，点击 <em>Object &gt; Clip &gt; set</em></li>
</ol>
]]></content>
  </entry>
  <entry>
    <title>仅用于测试</title>
    <url>/2020/01/19/%E4%BB%85%E7%94%A8%E4%BA%8E%E6%B5%8B%E8%AF%95/</url>
    <content><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><p>大家好，这是我的第一篇blog.</p>
]]></content>
  </entry>
</search>
